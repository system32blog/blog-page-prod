<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>system32</title><link>https://system32.blog/</link><description>Recent content on system32</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Mon, 08 Nov 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://system32.blog/index.xml" rel="self" type="application/rss+xml"/><item><title>PowerShell based PRTG Sensor Discovery</title><link>https://system32.blog/post/prtgsensordiscovery/</link><pubDate>Mon, 08 Nov 2021 00:00:00 +0000</pubDate><guid>https://system32.blog/post/prtgsensordiscovery/</guid><description>
&lt;p>This article shows a script I made to enhance PRTGs own sensor discovery. The script can be run as scheduled tasks and will use the PrtgApi to find any kind of sensors that you wish to monitor on your systems (such as Windows Services, NetApp Volumes, Cisco UCS Disks and so on)&lt;/p>
&lt;p>&lt;code>Disclaimer: This content and scripts are provided free of charge and I do not take any responsability for them nor any harm they may cause, it is up to you to review and test them properly before deploying them anywhere.&lt;/code>&lt;/p>
&lt;h1 id="introduction">Introduction&lt;/h1>
&lt;p>Many of you probably already heard about PRTG or are already using it to monitor your network. PRTG has a great builtin sensor discovery that will add sensors for almost everything you'd want to know about on your server.
One downside of this is the fact, that everytime you run this discovery, it adds all sensors once again as it does not check if this sensor is already there.&lt;/p>
&lt;p>To workaround this, I've build a PowerShell script that you can run as scheduled job to automatically discover any kind of discoverable sensor.&lt;/p>
&lt;p>The script is also able to send you a summary of what it discovered and created directly into your Teams Channel (via an Webhook Connector).&lt;/p>
&lt;h1 id="how-does-it-work">How does it work?&lt;/h1>
&lt;p>The script uses PRTGs inbuilt API and the PowerShell Module &amp;quot;PrtgAPI&amp;quot; (&lt;a href="https://github.com/lordmilko/PrtgAPI">https://github.com/lordmilko/PrtgAPI&lt;/a>) to invoke a sensor discovery for a specific sensor on a device or a group of devices.
After that it loops through the existing sensors to detect if there are any that are not explicitly excluded or already existent.&lt;/p>
&lt;p>The script has the following features and attributes per sensor type:&lt;/p>
&lt;ul>
&lt;li>RawType: The PRTG Name of a sensor, you can find all your PRTG Instance is aware off using the cmdlet &lt;code>Get-SensorType&lt;/code>.&lt;/li>
&lt;li>SensorPrefix: The prefix that is used by the sensor when you add them using the PRTG API.&lt;/li>
&lt;li>Group: The PRTG Device Group which the script shall run for this sensor type. If multiple groups with the same name exist (e.g. under different probes), it will run for all of them.&lt;/li>
&lt;li>NameFilter: A wildcard aware filter of devices the script shall run for. Do all your Windows Servers starts with &amp;quot;WSRV&amp;quot;? Great! Enter &amp;quot;WSRV*&amp;quot; into the NameFilter and you'll avoid unnecessary discoveries on not applicable devices. If not, just let the asterix in.&lt;/li>
&lt;li>AttributeName: The attribute name out of which the script shall extract the discovered sensors. This differs per sensor. You can find the correct property by running &lt;code>New-SensorParameters&lt;/code> on a device.&lt;/li>
&lt;li>ExclusionList: An array of occurences to ignore, in the existing sensor types below, you can find some examples. This exclusion list also supports wildcards.&lt;/li>
&lt;li>MaxSensors: A threshhold of how many sensors to discover per device. Exceeding this limit will fire an error message.&lt;/li>
&lt;li>DiscoveryInterval: A limitation of how often this Sensor Type discovery shall run, meaning that even if the script is executed multiple times in a row, if the discovery interval is not yet due again, it will skip this sensor type. An example of this would be disk sensors, discovering them all few days will be more than enough. Windows services however might pop up more often and therefor require a more frequent discovery. The last discovery is saved in the current user registry for each device, if you run the script on another device or under an other user context, it will start fresh.&lt;/li>
&lt;li>NameExtractionSB: An additional scriptblock that's being run against the object &lt;code>t&lt;/code> to extract the individual element name out of a device. This might be required for devices that return inconsistent or badly formatted informations around the actual device name. The &lt;code>Cisco UCS Disks&lt;/code> Sensor Type shows an example of it.&lt;/li>
&lt;/ul>
&lt;h1 id="how-to-use-it">How to use it&lt;/h1>
&lt;p>To use the script, you will need to populate the following environment variables before you execute the script:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-PowerShell" data-lang="PowerShell">&lt;span class="ln"> 1&lt;/span>&lt;span class="c"># Required&lt;/span>
&lt;span class="ln"> 2&lt;/span>&lt;span class="c">## PRTG server url&lt;/span>
&lt;span class="ln"> 3&lt;/span>&lt;span class="nv">$env:PRTGUrl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https://prtg.internaldomain.com&amp;#34;&lt;/span>
&lt;span class="ln"> 4&lt;/span>&lt;span class="c">## PRTG Username&lt;/span>
&lt;span class="ln"> 5&lt;/span>&lt;span class="nv">$env:PRTGUsername&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;svc-discovery&amp;#34;&lt;/span>
&lt;span class="ln"> 6&lt;/span>&lt;span class="c">## PRTG Password&lt;/span>
&lt;span class="ln"> 7&lt;/span>&lt;span class="nv">$env:PRTGPassword&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;bacon&amp;#34;&lt;/span>
&lt;span class="ln"> 8&lt;/span>
&lt;span class="ln"> 9&lt;/span>&lt;span class="c"># Optional&lt;/span>
&lt;span class="ln">10&lt;/span>&lt;span class="c">## A teams webhook to sent a summary of discovered sensors to (if any)&lt;/span>
&lt;span class="ln">11&lt;/span>&lt;span class="nv">$env:TeamsURL&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https://yourtenant.webhook.office.com/webhookb2/..&amp;#34;&lt;/span>
&lt;span class="ln">12&lt;/span>&lt;span class="c">## A teams webhook to sent a summary of discovered sensors to (if any) while using VSCode to work on the script&lt;/span>
&lt;span class="ln">13&lt;/span>&lt;span class="nv">$env:TeamsStagingURL&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https://yourtenant.webhook.office.com/webhookb2/..&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Depending on the number of items you got in the specified groups, it will take some time (minutes to hours) to discover the Sensor Types defined below.&lt;/p>
&lt;h2 id="predefined-sensor-types">Predefined Sensor Types&lt;/h2>
&lt;p>There is already a bunch of sensor types defined in the script, feel free to either keep them or delete them out of the hashtable. Those are the ones I've developed the script for and are actively used in my work environment.&lt;/p>
&lt;ul>
&lt;li>Cisco UCS Disks: Discover disk of a Cisco UCSC and Cisco UCSB Series using their CIMC Interface&lt;/li>
&lt;li>NetApp System Health: Discover NetApp System Health Sensors for each Controller&lt;/li>
&lt;li>NetApp IO: Discover NetApp IO Sensors for each Controller&lt;/li>
&lt;li>NetApp Aggregates: Discover NetApp Aggregates Sensors for all clusters&lt;/li>
&lt;li>NetApp Lifs: Discover NetApp Lif Sensors for each Controller&lt;/li>
&lt;li>NetApp Physical Disk: Discover NetApp Disk Sensors for each physical disk&lt;/li>
&lt;li>NetApp Interfaces: Discover NetApp Physical Interface Sensors for each&lt;/li>
&lt;li>NetApp Volumes: Discover NetApp Volume Sensors for each Cluster&lt;/li>
&lt;li>NetApp SnapMirrors: Discover NetApp Snapmirror/SnapVault Relationship Sensors for each Cluster&lt;/li>
&lt;li>Disk Space: Discover any available SNMP Disk Space Sensor (Windows/Linux) for each device&lt;/li>
&lt;li>Windows Services: Discover any running Windows Service via SNMP for each device. This Sensor Type already holds a long list of exclusions of builtin Windows Services in English and German OS. The reference lists are from Server 2019 Installations.&lt;/li>
&lt;/ul>
&lt;h1 id="the-script">The script&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-PowerShell" data-lang="PowerShell">&lt;span class="ln"> 1&lt;/span>&lt;span class="c">#region Variables&lt;/span>
&lt;span class="ln"> 2&lt;/span>&lt;span class="c"># Sensor Types&lt;/span>
&lt;span class="ln"> 3&lt;/span>&lt;span class="nv">$SensorTypes&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="no">[ordered]&lt;/span>&lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 4&lt;/span> &lt;span class="s2">&amp;#34;Cisco UCS Disks&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 5&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;snmpciscoucsphysicaldisk&amp;#39;&lt;/span>
&lt;span class="ln"> 6&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Physical Disk&amp;#34;&lt;/span>
&lt;span class="ln"> 7&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Management&amp;#34;&lt;/span>
&lt;span class="ln"> 8&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*CIMC&amp;#34;&lt;/span>
&lt;span class="ln"> 9&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;serial__check&amp;#34;&lt;/span>
&lt;span class="ln"> 10&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 11&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln"> 12&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln"> 13&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">30&lt;/span>
&lt;span class="ln"> 14&lt;/span> &lt;span class="n">NameExtractionSB&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="no">[scriptblock]&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln"> 15&lt;/span> &lt;span class="c"># Extract the pd-* Disk ID instead, otherwise we can&amp;#39;t identify the disk slot&lt;/span>
&lt;span class="ln"> 16&lt;/span> &lt;span class="nv">$t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Properties&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">2&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">Split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">)[-&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="ln"> 17&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 18&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln"> 19&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 20&lt;/span> &lt;span class="s2">&amp;#34;NetApp System Health&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 21&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotsystem&amp;#39;&lt;/span>
&lt;span class="ln"> 22&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 23&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 24&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 25&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 26&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 27&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 28&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln"> 29&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 30&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp System Health&amp;#34;&lt;/span>
&lt;span class="ln"> 31&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln"> 32&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln"> 33&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cdotnodename__check&amp;#34;&lt;/span>
&lt;span class="ln"> 34&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 35&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln"> 36&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln"> 37&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">10&lt;/span>
&lt;span class="ln"> 38&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln"> 39&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 40&lt;/span> &lt;span class="s2">&amp;#34;NetApp IO&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 41&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotio&amp;#39;&lt;/span>
&lt;span class="ln"> 42&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 43&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 44&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 45&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 46&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 47&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 48&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln"> 49&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 50&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp I/O&amp;#34;&lt;/span>
&lt;span class="ln"> 51&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln"> 52&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln"> 53&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cdotnodename__check&amp;#34;&lt;/span>
&lt;span class="ln"> 54&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 55&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln"> 56&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln"> 57&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">10&lt;/span>
&lt;span class="ln"> 58&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln"> 59&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 60&lt;/span> &lt;span class="s2">&amp;#34;NetApp Aggregate&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 61&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotaggr&amp;#39;&lt;/span>
&lt;span class="ln"> 62&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 63&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 64&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 65&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 66&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 67&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 68&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln"> 69&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 70&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp Aggregate&amp;#34;&lt;/span>
&lt;span class="ln"> 71&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln"> 72&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln"> 73&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;netappcdotaggrlist__check&amp;#34;&lt;/span>
&lt;span class="ln"> 74&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 75&lt;/span> &lt;span class="s2">&amp;#34;*root*&amp;#34;&lt;/span>
&lt;span class="ln"> 76&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln"> 77&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">100&lt;/span>
&lt;span class="ln"> 78&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln"> 79&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 80&lt;/span> &lt;span class="s2">&amp;#34;NetApp Lif&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 81&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotlif&amp;#39;&lt;/span>
&lt;span class="ln"> 82&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 83&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 84&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 85&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 86&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 87&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln"> 88&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln"> 89&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 90&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp Lif&amp;#34;&lt;/span>
&lt;span class="ln"> 91&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln"> 92&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln"> 93&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;netappcdotliflist__check&amp;#34;&lt;/span>
&lt;span class="ln"> 94&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 95&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln"> 96&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln"> 97&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">50&lt;/span>
&lt;span class="ln"> 98&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln"> 99&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">100&lt;/span> &lt;span class="s2">&amp;#34;NetApp Physical Disk&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">101&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotdisk&amp;#39;&lt;/span>
&lt;span class="ln">102&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">103&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">104&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">105&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">106&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">107&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">108&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln">109&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">110&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp Physical Disk&amp;#34;&lt;/span>
&lt;span class="ln">111&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln">112&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">113&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;netappcdotdisklist__check&amp;#34;&lt;/span>
&lt;span class="ln">114&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">115&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln">116&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">117&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">200&lt;/span>
&lt;span class="ln">118&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln">119&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">120&lt;/span> &lt;span class="s2">&amp;#34;NetApp Interfaces&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">121&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;snmpnetappnetworkinterface&amp;#39;&lt;/span>
&lt;span class="ln">122&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">123&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">124&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">125&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">126&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">127&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">128&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln">129&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">130&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Network Interface:&amp;#34;&lt;/span>
&lt;span class="ln">131&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln">132&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">133&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;interface__check&amp;#34;&lt;/span>
&lt;span class="ln">134&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">135&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="ln">136&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">137&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">50&lt;/span>
&lt;span class="ln">138&lt;/span> &lt;span class="n">DiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">168&lt;/span>
&lt;span class="ln">139&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">140&lt;/span> &lt;span class="s2">&amp;#34;NetApp Volumes&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">141&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotvolume&amp;#39;&lt;/span>
&lt;span class="ln">142&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">143&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">144&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">145&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">146&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">147&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">148&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln">149&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">150&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp Volume&amp;#34;&lt;/span>
&lt;span class="ln">151&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln">152&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">153&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;netappcdotvolumelist__check&amp;#34;&lt;/span>
&lt;span class="ln">154&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">155&lt;/span> &lt;span class="s2">&amp;#34;*root*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">156&lt;/span> &lt;span class="s1">&amp;#39;*.snapshot*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">157&lt;/span> &lt;span class="s1">&amp;#39;sdw_*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">158&lt;/span> &lt;span class="s1">&amp;#39;*/sdw_*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">159&lt;/span> &lt;span class="s1">&amp;#39;*:vol0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">160&lt;/span> &lt;span class="s1">&amp;#39;*:sdw_*&amp;#39;&lt;/span>
&lt;span class="ln">161&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">162&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">25&lt;/span>
&lt;span class="ln">163&lt;/span>
&lt;span class="ln">164&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">165&lt;/span> &lt;span class="s2">&amp;#34;NetApp SnapMirror&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">166&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;netappcdotsnapmirror&amp;#39;&lt;/span>
&lt;span class="ln">167&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">168&lt;/span> &lt;span class="s2">&amp;#34;defaultlogin_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">169&lt;/span> &lt;span class="s2">&amp;#34;user_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">170&lt;/span> &lt;span class="s2">&amp;#34;password_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">171&lt;/span> &lt;span class="s2">&amp;#34;transporttype_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">172&lt;/span> &lt;span class="s2">&amp;#34;timeout_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">60&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">173&lt;/span> &lt;span class="s2">&amp;#34;port_&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">443&lt;/span>
&lt;span class="ln">174&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">175&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;NetApp SnapMirror&amp;#34;&lt;/span>
&lt;span class="ln">176&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Storage&amp;#34;&lt;/span>
&lt;span class="ln">177&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">178&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cdotsnapmirrorlist__check&amp;#34;&lt;/span>
&lt;span class="ln">179&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">20&lt;/span>
&lt;span class="ln">180&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">181&lt;/span> &lt;span class="s2">&amp;#34;*root*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">182&lt;/span> &lt;span class="s1">&amp;#39;*.snapshot*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">183&lt;/span> &lt;span class="s1">&amp;#39;sdw_*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">184&lt;/span> &lt;span class="s1">&amp;#39;*/sdw_*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">185&lt;/span> &lt;span class="s1">&amp;#39;*:vol0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">186&lt;/span> &lt;span class="s1">&amp;#39;*:sdw_*&amp;#39;&lt;/span>
&lt;span class="ln">187&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">188&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">189&lt;/span> &lt;span class="s2">&amp;#34;Disk Space&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">190&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;snmpdiskfree&amp;#39;&lt;/span>
&lt;span class="ln">191&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">192&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">193&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Disk Free:&amp;#34;&lt;/span>
&lt;span class="ln">194&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Server&amp;#34;&lt;/span>
&lt;span class="ln">195&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">196&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;disk__check&amp;#34;&lt;/span>
&lt;span class="ln">197&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">198&lt;/span> &lt;span class="s2">&amp;#34;/run/user/*&amp;#34;&lt;/span>
&lt;span class="ln">199&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">200&lt;/span>
&lt;span class="ln">201&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">202&lt;/span> &lt;span class="s2">&amp;#34;Windows Services&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">203&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;snmpservice&amp;#39;&lt;/span>
&lt;span class="ln">204&lt;/span> &lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">205&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">206&lt;/span> &lt;span class="n">SensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Service&amp;#34;&lt;/span>
&lt;span class="ln">207&lt;/span> &lt;span class="nb">Group &lt;/span>&lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Server&amp;#34;&lt;/span>
&lt;span class="ln">208&lt;/span> &lt;span class="n">NameFilter&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;*&amp;#34;&lt;/span>
&lt;span class="ln">209&lt;/span> &lt;span class="n">AttributeName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;service__check&amp;#34;&lt;/span>
&lt;span class="ln">210&lt;/span> &lt;span class="n">MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">15&lt;/span>
&lt;span class="ln">211&lt;/span> &lt;span class="n">ExclusionList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">212&lt;/span> &lt;span class="s2">&amp;#34;Power&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">213&lt;/span> &lt;span class="s2">&amp;#34;Server&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">214&lt;/span> &lt;span class="s2">&amp;#34;Themes&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">215&lt;/span> &lt;span class="s2">&amp;#34;SysMain&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">216&lt;/span> &lt;span class="s2">&amp;#34;Netlogon&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">217&lt;/span> &lt;span class="s2">&amp;#34;IP Helper&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">218&lt;/span> &lt;span class="s2">&amp;#34;DNS Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">219&lt;/span> &lt;span class="s2">&amp;#34;winlogbeat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">220&lt;/span> &lt;span class="s2">&amp;#34;DHCP Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">221&lt;/span> &lt;span class="s2">&amp;#34;Time Broker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">222&lt;/span> &lt;span class="s2">&amp;#34;Workstation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">223&lt;/span> &lt;span class="s2">&amp;#34;SNMP Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">224&lt;/span> &lt;span class="s2">&amp;#34;User Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">225&lt;/span> &lt;span class="s2">&amp;#34;Windows Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">226&lt;/span> &lt;span class="s2">&amp;#34;CoreMessaging&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">227&lt;/span> &lt;span class="s2">&amp;#34;Plug and Play&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">228&lt;/span> &lt;span class="s2">&amp;#34;SMS Agent Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">229&lt;/span> &lt;span class="s2">&amp;#34;Task Scheduler&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">230&lt;/span> &lt;span class="s2">&amp;#34;Message Queuing&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">231&lt;/span> &lt;span class="s2">&amp;#34;Storage Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">232&lt;/span> &lt;span class="s2">&amp;#34;CNG Key Isolation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">233&lt;/span> &lt;span class="s2">&amp;#34;COM+ Event System&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">234&lt;/span> &lt;span class="s2">&amp;#34;COM+-Systemanwendung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">235&lt;/span> &lt;span class="s2">&amp;#34;IIS Admin Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">236&lt;/span> &lt;span class="s2">&amp;#34;Windows Event Log&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">237&lt;/span> &lt;span class="s2">&amp;#34;IPsec Policy Agent&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">238&lt;/span> &lt;span class="s2">&amp;#34;Volume Shadow Copy&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">239&lt;/span> &lt;span class="s2">&amp;#34;Group Policy Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">240&lt;/span> &lt;span class="s2">&amp;#34;Network Connections&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">241&lt;/span> &lt;span class="s2">&amp;#34;RPC Endpoint Mapper&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">242&lt;/span> &lt;span class="s2">&amp;#34;Web Account Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">243&lt;/span> &lt;span class="s2">&amp;#34;Apex One NT Listener&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">244&lt;/span> &lt;span class="s2">&amp;#34;Data Sharing Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">245&lt;/span> &lt;span class="s2">&amp;#34;Network List Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">246&lt;/span> &lt;span class="s2">&amp;#34;System Events Broker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">247&lt;/span> &lt;span class="s2">&amp;#34;User Profile Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">248&lt;/span> &lt;span class="s2">&amp;#34;Base Filtering Engine&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">249&lt;/span> &lt;span class="s2">&amp;#34;Local Session Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">250&lt;/span> &lt;span class="s2">&amp;#34;TCP/IP NetBIOS Helper&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">251&lt;/span> &lt;span class="s2">&amp;#34;Cryptographic Services&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">252&lt;/span> &lt;span class="s2">&amp;#34;Apex One NT WSC Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">253&lt;/span> &lt;span class="s2">&amp;#34;Application Information&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">254&lt;/span> &lt;span class="s2">&amp;#34;Certificate Propagation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">255&lt;/span> &lt;span class="s2">&amp;#34;Diagnostic Service Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">256&lt;/span> &lt;span class="s2">&amp;#34;Remote Desktop Services&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">257&lt;/span> &lt;span class="s2">&amp;#34;Net.Tcp Listener Adapter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">258&lt;/span> &lt;span class="s2">&amp;#34;Shell Hardware Detection&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">259&lt;/span> &lt;span class="s2">&amp;#34;State Repository Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">260&lt;/span> &lt;span class="s2">&amp;#34;Apex One NT RealTime Scan&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">261&lt;/span> &lt;span class="s2">&amp;#34;Diagnostic Policy Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">262&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Heartbeat Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">263&lt;/span> &lt;span class="s2">&amp;#34;Net.Msmq Listener Adapter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">264&lt;/span> &lt;span class="s2">&amp;#34;Net.Pipe Listener Adapter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">265&lt;/span> &lt;span class="s2">&amp;#34;Network Connection Broker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">266&lt;/span> &lt;span class="s2">&amp;#34;Security Accounts Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">267&lt;/span> &lt;span class="s2">&amp;#34;Windows Defender Firewall&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">268&lt;/span> &lt;span class="s2">&amp;#34;Network Location Awareness&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">269&lt;/span> &lt;span class="s2">&amp;#34;Windows Connection Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">270&lt;/span> &lt;span class="s2">&amp;#34;Windows Font Cache Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">271&lt;/span> &lt;span class="s2">&amp;#34;Remote Procedure Call (RPC)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">272&lt;/span> &lt;span class="s2">&amp;#34;Update Orchestrator Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">273&lt;/span> &lt;span class="s2">&amp;#34;User Access Logging Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">274&lt;/span> &lt;span class="s2">&amp;#34;DCOM Server Process Launcher&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">275&lt;/span> &lt;span class="s2">&amp;#34;Net.Tcp Port Sharing Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">276&lt;/span> &lt;span class="s2">&amp;#34;Remote Desktop Configuration&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">277&lt;/span> &lt;span class="s2">&amp;#34;Windows Update Medic Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">278&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Data Exchange Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">279&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Guest Shutdown Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">280&lt;/span> &lt;span class="s2">&amp;#34;Application Host Helper Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">281&lt;/span> &lt;span class="s2">&amp;#34;Network Store Interface Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">282&lt;/span> &lt;span class="s2">&amp;#34;Windows License Manager Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">283&lt;/span> &lt;span class="s2">&amp;#34;Distributed Link Tracking Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">284&lt;/span> &lt;span class="s2">&amp;#34;Remote Access Connection Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">285&lt;/span> &lt;span class="s2">&amp;#34;CrowdStrike Falcon Sensor Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">286&lt;/span> &lt;span class="s2">&amp;#34;System Event Notification Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">287&lt;/span> &lt;span class="s2">&amp;#34;Connected Devices Platform Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">288&lt;/span> &lt;span class="s2">&amp;#34;Windows Management Instrumentation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">289&lt;/span> &lt;span class="s2">&amp;#34;Windows Process Activation Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">290&lt;/span> &lt;span class="s2">&amp;#34;Distributed Transaction Coordinator&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">291&lt;/span> &lt;span class="s2">&amp;#34;IKE and AuthIP IPsec Keying Modules&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">292&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Volume Shadow Copy Requestor&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">293&lt;/span> &lt;span class="s2">&amp;#34;Background Tasks Infrastructure Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">294&lt;/span> &lt;span class="s2">&amp;#34;Program Compatibility Assistant Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">295&lt;/span> &lt;span class="s2">&amp;#34;Connected User Experiences and Telemetry&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">296&lt;/span> &lt;span class="s2">&amp;#34;Secure Socket Tunneling Protocol Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">297&lt;/span> &lt;span class="s2">&amp;#34;WinHTTP Web Proxy Auto-Discovery Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">298&lt;/span> &lt;span class="s2">&amp;#34;Windows Push Notifications System Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">299&lt;/span> &lt;span class="s2">&amp;#34;Windows Remote Management (WS-Management)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">300&lt;/span> &lt;span class="s2">&amp;#34;Touch Keyboard and Handwriting Panel Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">301&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Remote Desktop Virtualization Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">302&lt;/span> &lt;span class="s2">&amp;#34;Connected Devices Platform User Service_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">303&lt;/span> &lt;span class="s2">&amp;#34;Windows Push Notifications User Service_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">304&lt;/span> &lt;span class="s2">&amp;#34;Remote Desktop Services UserMode Port Redirector&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">305&lt;/span> &lt;span class="s2">&amp;#34;Windows Update&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">306&lt;/span> &lt;span class="s2">&amp;#34;Windows Installer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">307&lt;/span> &lt;span class="s2">&amp;#34;Network Setup Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">308&lt;/span> &lt;span class="s2">&amp;#34;Diagnostic System Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">309&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Policy Platform Processor&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">310&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Policy Platform Local Authority&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">311&lt;/span> &lt;span class="s2">&amp;#34;Print Spooler&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">312&lt;/span> &lt;span class="s2">&amp;#34;Windows Search&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">313&lt;/span> &lt;span class="s2">&amp;#34;Computer Browser&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">314&lt;/span> &lt;span class="s2">&amp;#34;Windows Modules Installer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">315&lt;/span> &lt;span class="s2">&amp;#34;Extensible Authentication Protocol&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">316&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Software Shadow Copy Provider&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">317&lt;/span> &lt;span class="s2">&amp;#34;CDPUserSvc_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">318&lt;/span> &lt;span class="s2">&amp;#34;Geolocation Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">319&lt;/span> &lt;span class="s2">&amp;#34;VMware *&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">320&lt;/span> &lt;span class="s2">&amp;#34;SSDP Discovery&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">321&lt;/span> &lt;span class="s2">&amp;#34;Virtual Disk&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">322&lt;/span> &lt;span class="s2">&amp;#34;Windows Firewall&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">323&lt;/span> &lt;span class="s2">&amp;#34;Tile Data model server&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">324&lt;/span> &lt;span class="s2">&amp;#34;Smart Card Device Enumeration Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">325&lt;/span> &lt;span class="s2">&amp;#34;Background Intelligent Transfer Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">326&lt;/span> &lt;span class="s2">&amp;#34;Windows Driver Foundation - User-mode Driver Framework&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">327&lt;/span> &lt;span class="s2">&amp;#34;Diagnostics Tracking Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">328&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Online Services Sign-in Assistant&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">329&lt;/span> &lt;span class="s2">&amp;#34;Messaging&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">330&lt;/span> &lt;span class="s2">&amp;#34;Experience&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">331&lt;/span> &lt;span class="s2">&amp;#34;Diagnostics Tracking Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">332&lt;/span> &lt;span class="s2">&amp;#34;Performance Logs &amp;amp; Alerts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">333&lt;/span> &lt;span class="s2">&amp;#34;Intersite Messaging&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">334&lt;/span> &lt;span class="s2">&amp;#34;dmwappushsvc&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">335&lt;/span> &lt;span class="s2">&amp;#34;Superfetch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">336&lt;/span> &lt;span class="s2">&amp;#34;Credential Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">337&lt;/span> &lt;span class="s2">&amp;#34;Windows Audio&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">338&lt;/span> &lt;span class="s2">&amp;#34;Application Experience&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">339&lt;/span> &lt;span class="s2">&amp;#34;Windows Internal Database VSS Writer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">340&lt;/span> &lt;span class="s2">&amp;#34;Application Management&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">341&lt;/span> &lt;span class="s2">&amp;#34;WMI Performance Adapter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">342&lt;/span> &lt;span class="s2">&amp;#34;Software Protection&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">343&lt;/span> &lt;span class="s2">&amp;#34;Secondary Logon&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">344&lt;/span> &lt;span class="s2">&amp;#34;Device Association Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">345&lt;/span> &lt;span class="s2">&amp;#34;Windows Image Acquisition (WIA)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">346&lt;/span> &lt;span class="s2">&amp;#34;AppX Deployment Service (AppXSVC)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">347&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V Time Synchronization Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">348&lt;/span> &lt;span class="s2">&amp;#34;KDC Proxy Server service (KPS)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">349&lt;/span> &lt;span class="s2">&amp;#34;Remote Registry&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">350&lt;/span> &lt;span class="s2">&amp;#34;Password Export Server Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">351&lt;/span> &lt;span class="s2">&amp;#34;Portable Device Enumerator Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">352&lt;/span> &lt;span class="s2">&amp;#34;Adobe Acrobat*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">353&lt;/span> &lt;span class="s2">&amp;#34;Sync Host_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">354&lt;/span> &lt;span class="s2">&amp;#34;Encrypting File System (EFS)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">355&lt;/span> &lt;span class="s2">&amp;#34;SAPSetup Automatic Workstation Update Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">356&lt;/span> &lt;span class="s2">&amp;#34;Telephony&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">357&lt;/span> &lt;span class="s2">&amp;#34;GDMA&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">358&lt;/span> &lt;span class="s2">&amp;#34;Windows Insider Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">359&lt;/span> &lt;span class="s2">&amp;#34;Windows Error Reporting Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">360&lt;/span> &lt;span class="s2">&amp;#34;AVCTP service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">361&lt;/span> &lt;span class="s2">&amp;#34;Windows Internal Database*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">362&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Office Click-to-Run Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">363&lt;/span> &lt;span class="s2">&amp;#34;Windows Audio Endpoint builder&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">364&lt;/span> &lt;span class="s2">&amp;#34;Office Software Protection Platform&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">365&lt;/span> &lt;span class="s2">&amp;#34;Designs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">366&lt;/span> &lt;span class="s2">&amp;#34;DNS-Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">367&lt;/span> &lt;span class="s2">&amp;#34;DHCP-Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">368&lt;/span> &lt;span class="s2">&amp;#34;Plug &amp;amp; Play&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">369&lt;/span> &lt;span class="s2">&amp;#34;SNMP-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">370&lt;/span> &lt;span class="s2">&amp;#34;Anmeldedienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">371&lt;/span> &lt;span class="s2">&amp;#34;IP-Hilfsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">372&lt;/span> &lt;span class="s2">&amp;#34;Aufgabenplanung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">373&lt;/span> &lt;span class="s2">&amp;#34;Windows Audio*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">374&lt;/span> &lt;span class="s2">&amp;#34;Device Install Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">375&lt;/span> &lt;span class="s2">&amp;#34;Client for NFS&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">376&lt;/span> &lt;span class="s2">&amp;#34;Data Deduplication Volume Shadow Copy Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">377&lt;/span> &lt;span class="s2">&amp;#34;WMI Performmance Adapter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">378&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Account Sign-in Assistant&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">379&lt;/span> &lt;span class="s2">&amp;#34;SNMP Trap&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">380&lt;/span> &lt;span class="s2">&amp;#34;Function Discovery Resource Publication&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">381&lt;/span> &lt;span class="s2">&amp;#34;BITS&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">382&lt;/span> &lt;span class="s2">&amp;#34;W32Time&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">383&lt;/span> &lt;span class="s2">&amp;#34;Device Setup Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">384&lt;/span> &lt;span class="s2">&amp;#34;Windows Security Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">385&lt;/span> &lt;span class="s2">&amp;#34;SQL Server CEIP service*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">386&lt;/span> &lt;span class="s2">&amp;#34;Server&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">387&lt;/span> &lt;span class="s2">&amp;#34;Designs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">388&lt;/span> &lt;span class="s2">&amp;#34;DNS-Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">389&lt;/span> &lt;span class="s2">&amp;#34;winlogbeat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">390&lt;/span> &lt;span class="s2">&amp;#34;DHCP-Client&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">391&lt;/span> &lt;span class="s2">&amp;#34;Plug \u0026 Play&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">392&lt;/span> &lt;span class="s2">&amp;#34;SNMP-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">393&lt;/span> &lt;span class="s2">&amp;#34;Anmeldedienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">394&lt;/span> &lt;span class="s2">&amp;#34;IP-Hilfsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">395&lt;/span> &lt;span class="s2">&amp;#34;SMS Agent Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">396&lt;/span> &lt;span class="s2">&amp;#34;Aufgabenplanung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">397&lt;/span> &lt;span class="s2">&amp;#34;Stromversorgung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">398&lt;/span> &lt;span class="s2">&amp;#34;Basisfiltermodul&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">399&lt;/span> &lt;span class="s2">&amp;#34;Windows-Firewall&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">400&lt;/span> &lt;span class="s2">&amp;#34;Windows-Zeitgeber&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">401&lt;/span> &lt;span class="s2">&amp;#34;Druckwarteschlange&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">402&lt;/span> &lt;span class="s2">&amp;#34;SQL Server-Browser&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">403&lt;/span> &lt;span class="s2">&amp;#34;COM+-Ereignissystem&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">404&lt;/span> &lt;span class="s2">&amp;#34;Kryptografiedienste&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">405&lt;/span> &lt;span class="s2">&amp;#34;Volumeschattenkopie&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">406&lt;/span> &lt;span class="s2">&amp;#34;Benutzerprofildienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">407&lt;/span> &lt;span class="s2">&amp;#34;Netzwerklistendienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">408&lt;/span> &lt;span class="s2">&amp;#34;Netzwerkverbindungen&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">409&lt;/span> &lt;span class="s2">&amp;#34;Remotedesktopdienste&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">410&lt;/span> &lt;span class="s2">&amp;#34;Zertifikatverteilung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">411&lt;/span> &lt;span class="s2">&amp;#34;Arbeitsstationsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">412&lt;/span> &lt;span class="s2">&amp;#34;RPC-Endpunktzuordnung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">413&lt;/span> &lt;span class="s2">&amp;#34;Systemereignissebroker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">414&lt;/span> &lt;span class="s2">&amp;#34;Anwendungsinformationen&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">415&lt;/span> &lt;span class="s2">&amp;#34;Apex One NT WSC Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">416&lt;/span> &lt;span class="s2">&amp;#34;CNG-Schlüsselisolation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">417&lt;/span> &lt;span class="s2">&amp;#34;IPsec-Richtlinien-Agent&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">418&lt;/span> &lt;span class="s2">&amp;#34;DCOM-Server-Prozessstart&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">419&lt;/span> &lt;span class="s2">&amp;#34;Gruppenrichtlinienclient&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">420&lt;/span> &lt;span class="s2">&amp;#34;Lokaler Sitzungs-Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">421&lt;/span> &lt;span class="s2">&amp;#34;Sicherheitskonto-Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">422&lt;/span> &lt;span class="s2">&amp;#34;Apex One NT RealTime Scan&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">423&lt;/span> &lt;span class="s2">&amp;#34;Diagnoserichtliniendienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">424&lt;/span> &lt;span class="s2">&amp;#34;Windows-Ereignisprotokoll&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">425&lt;/span> &lt;span class="s2">&amp;#34;Remoteprozeduraufruf (RPC)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">426&lt;/span> &lt;span class="s2">&amp;#34;TCP/IP-NetBIOS-Hilfsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">427&lt;/span> &lt;span class="s2">&amp;#34;VMware SVGA Helper Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">428&lt;/span> &lt;span class="s2">&amp;#34;Windows-Verbindungs-Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">429&lt;/span> &lt;span class="s2">&amp;#34;Diagnostics Tracking Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">430&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Datenaustauschdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">431&lt;/span> &lt;span class="s2">&amp;#34;Konfiguration für Remotedesktops&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">432&lt;/span> &lt;span class="s2">&amp;#34;Windows-Verwaltungsinstrumentation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">433&lt;/span> &lt;span class="s2">&amp;#34;Distributed Transaction Coordinator&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">434&lt;/span> &lt;span class="s2">&amp;#34;Netzwerkspeicher-Schnittstellendienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">435&lt;/span> &lt;span class="s2">&amp;#34;Windows-Dienst für Schriftartencache&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">436&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Volumeschattenkopie-Anforderer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">437&lt;/span> &lt;span class="s2">&amp;#34;WinHTTP-Web Proxy Auto-Discovery-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">438&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Dienst für Zeitsynchronisierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">439&lt;/span> &lt;span class="s2">&amp;#34;Windows-Remoteverwaltung (WS-Verwaltung)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">440&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Dienst zum Herunterfahren des Gasts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">441&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Remotedesktopvirtualisierungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">442&lt;/span> &lt;span class="s2">&amp;#34;Infrastrukturdienst für Hintergrundaufgaben&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">443&lt;/span> &lt;span class="s2">&amp;#34;Intelligenter Hintergrundübertragungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">444&lt;/span> &lt;span class="s2">&amp;#34;Benachrichtigungsdienst für Systemereignisse&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">445&lt;/span> &lt;span class="s2">&amp;#34;Dienst für die Benutzerzugriffsprotokollierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">446&lt;/span> &lt;span class="s2">&amp;#34;Überwachung verteilter Verknüpfungen (Client)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">447&lt;/span> &lt;span class="s2">&amp;#34;IKE- und AuthIP IPsec-Schlüsselerstellungsmodule&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">448&lt;/span> &lt;span class="s2">&amp;#34;Anschlussumleitung für Remotedesktopdienst im Benutzermodus&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">449&lt;/span> &lt;span class="s2">&amp;#34;SMS_SITE_SQL_BACKUP&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">450&lt;/span> &lt;span class="s2">&amp;#34;Data ONTAP VSS Hardware Provider&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">451&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Storage Spaces SMP&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">452&lt;/span> &lt;span class="s2">&amp;#34;App Readiness&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">453&lt;/span> &lt;span class="s2">&amp;#34;CNG-Schlüsselisolation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">454&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Taktdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">455&lt;/span> &lt;span class="s2">&amp;#34;Anschlussumleitung für Remotedesktopdienst im Benutzermodus&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">456&lt;/span> &lt;span class="s2">&amp;#34;NLA (Network Location Awareness)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">457&lt;/span> &lt;span class="s2">&amp;#34;Konfiguration für Remotedesktops&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">458&lt;/span> &lt;span class="s2">&amp;#34;Windows-Dienst für Schriftartencache&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">459&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Dienst für Zeitsynchronisierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">460&lt;/span> &lt;span class="s2">&amp;#34;Infrastrukturdienst für Hintergrundaufgaben&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">461&lt;/span> &lt;span class="s2">&amp;#34;Intelligenter Hintergrundübertragungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">462&lt;/span> &lt;span class="s2">&amp;#34;Benachrichtigungsdienst für Systemereignisse&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">463&lt;/span> &lt;span class="s2">&amp;#34;Dienst für die Benutzerzugriffsprotokollierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">464&lt;/span> &lt;span class="s2">&amp;#34;Überwachung verteilter Verknüpfungen (Client)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">465&lt;/span> &lt;span class="s2">&amp;#34;IKE- und AuthIP IPsec-Schlüsselerstellungsmodule&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">466&lt;/span> &lt;span class="s2">&amp;#34;Function Discovery Provider Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">467&lt;/span> &lt;span class="s2">&amp;#34;Intel(R) PROSet Monitoring Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">468&lt;/span> &lt;span class="s2">&amp;#34;KtmRm for Distributed Transaction Coordinator&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">469&lt;/span> &lt;span class="s2">&amp;#34;Network Virtualization Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">470&lt;/span> &lt;span class="s2">&amp;#34;Application Identity&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">471&lt;/span> &lt;span class="s2">&amp;#34;Contact Data_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">472&lt;/span> &lt;span class="s2">&amp;#34;User Data Access_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">473&lt;/span> &lt;span class="s2">&amp;#34;User Data Storage_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">474&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Passport*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">475&lt;/span> &lt;span class="s2">&amp;#34;Client License Service (ClipSVC)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">476&lt;/span> &lt;span class="s2">&amp;#34;Capability Access Manager Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">477&lt;/span> &lt;span class="s2">&amp;#34;Diagnosesystemhost&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">478&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Edge Update Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">479&lt;/span> &lt;span class="s2">&amp;#34;Delivery Optimization&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">480&lt;/span> &lt;span class="s2">&amp;#34;Optimize drives&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">481&lt;/span> &lt;span class="s2">&amp;#34;Data Deduplication Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">482&lt;/span> &lt;span class="s2">&amp;#34;Clipboard User Service_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">483&lt;/span> &lt;span class="s2">&amp;#34;Netzwerkeinrichtungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">484&lt;/span> &lt;span class="s2">&amp;#34;Benutzerdienst für die Plattform für verbundene Geräte_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">485&lt;/span> &lt;span class="s2">&amp;#34;PrintWorkflow_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">486&lt;/span> &lt;span class="s2">&amp;#34;Windows-Pushbenachrichtigungs-Benutzerdienst_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">487&lt;/span> &lt;span class="s2">&amp;#34;Contact Data_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">488&lt;/span> &lt;span class="s2">&amp;#34;Windows-Lizenz-Manager-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">489&lt;/span> &lt;span class="s2">&amp;#34;Verschlüsselndes Dateisystem (EFS)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">490&lt;/span> &lt;span class="s2">&amp;#34;Übermittlungsoptimierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">491&lt;/span> &lt;span class="s2">&amp;#34;Shellhardwareerkennung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">492&lt;/span> &lt;span class="s2">&amp;#34;Datenfreigabedienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">493&lt;/span> &lt;span class="s2">&amp;#34;Bluetooth-Unterstützungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">494&lt;/span> &lt;span class="s2">&amp;#34;BITS Compact Server&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">495&lt;/span> &lt;span class="s2">&amp;#34;AVCTP-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">496&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Key Distribution Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">497&lt;/span> &lt;span class="s2">&amp;#34;CNG-Schlüsselisolation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">498&lt;/span> &lt;span class="s2">&amp;#34;Konfiguration für Remotedesktops&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">499&lt;/span> &lt;span class="s2">&amp;#34;Windows-Dienst für Schriftartencache&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">500&lt;/span> &lt;span class="s2">&amp;#34;Hyper-V-Dienst für Zeitsynchronisierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">501&lt;/span> &lt;span class="s2">&amp;#34;Infrastrukturdienst für Hintergrundaufgaben&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">502&lt;/span> &lt;span class="s2">&amp;#34;Intelligenter Hintergrundübertragungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">503&lt;/span> &lt;span class="s2">&amp;#34;Benachrichtigungsdienst für Systemereignisse&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">504&lt;/span> &lt;span class="s2">&amp;#34;Dienst für die Benutzerzugriffsprotokollierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">505&lt;/span> &lt;span class="s2">&amp;#34;Überwachung verteilter Verknüpfungen (Client)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">506&lt;/span> &lt;span class="s2">&amp;#34;IKE- und AuthIP IPsec-Schlüsselerstellungsmodule&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">507&lt;/span> &lt;span class="s2">&amp;#34;Anschlussumleitung für Remotedesktopdienst im Benutzermodus&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">508&lt;/span> &lt;span class="s2">&amp;#34;Anwendungshost-Hilfsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">509&lt;/span> &lt;span class="s2">&amp;#34;Anmeldeinformationsverwaltung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">510&lt;/span> &lt;span class="s2">&amp;#34;Windows-Prozessaktivierungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">511&lt;/span> &lt;span class="s2">&amp;#34;Windows Store Service (WSService)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">512&lt;/span> &lt;span class="s2">&amp;#34;Zeitbroker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">513&lt;/span> &lt;span class="s2">&amp;#34;SSTP-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">514&lt;/span> &lt;span class="s2">&amp;#34;Windows-Audio&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">515&lt;/span> &lt;span class="s2">&amp;#34;Speicherdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">516&lt;/span> &lt;span class="s2">&amp;#34;Benutzer-Manager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">517&lt;/span> &lt;span class="s2">&amp;#34;StateRepository-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">518&lt;/span> &lt;span class="s2">&amp;#34;Netzwerkverbindungsbroker&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">519&lt;/span> &lt;span class="s2">&amp;#34;RAS-Verbindungsverwaltung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">520&lt;/span> &lt;span class="s2">&amp;#34;Plattformdienst für verbundene Geräte&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">521&lt;/span> &lt;span class="s2">&amp;#34;Programmkompatibilitäts-Assistent-Dienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">522&lt;/span> &lt;span class="s2">&amp;#34;Windows-Pushbenachrichtigungssystemdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">523&lt;/span> &lt;span class="s2">&amp;#34;Dienst für Bildschirmtastatur und Schreibbereich&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">524&lt;/span> &lt;span class="s2">&amp;#34;Benutzererfahrungen und Telemetrie im verbundenen Modus&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">525&lt;/span> &lt;span class="s2">&amp;#34;Windows Biometric Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">526&lt;/span> &lt;span class="s2">&amp;#34;COM+ System Application&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">527&lt;/span> &lt;span class="s2">&amp;#34;Update Orchestrator Service for Windows Update&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">528&lt;/span> &lt;span class="s2">&amp;#34;Windows-Audio-Endpunkterstellung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">529&lt;/span> &lt;span class="s2">&amp;#34;Microsoft-Softwareschattenkopie-Anbieter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">530&lt;/span> &lt;span class="s2">&amp;#34;Tracing Service for Search in Exchange&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">531&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Edge Update Service (edgeupdate)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">532&lt;/span> &lt;span class="s2">&amp;#34;Problem Reports and Solutions Control Panel Support&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">533&lt;/span> &lt;span class="s2">&amp;#34;Remoteregistrierung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">534&lt;/span> &lt;span class="s2">&amp;#34;Smartcard-Geräteaufzählungsdienst&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">535&lt;/span> &lt;span class="s2">&amp;#34;Update Orchestrator Service for Windows Update&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">536&lt;/span> &lt;span class="s2">&amp;#34;Veeam Agent for Microsoft Windows&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">537&lt;/span> &lt;span class="s2">&amp;#34;AzureAttestService&amp;#34;&lt;/span>
&lt;span class="ln">538&lt;/span> &lt;span class="s2">&amp;#34;CsInstallService&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">539&lt;/span> &lt;span class="s2">&amp;#34;ConfigMgr Task Sequence Agent&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">540&lt;/span> &lt;span class="s2">&amp;#34;Diagnosediensthost&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">541&lt;/span> &lt;span class="s2">&amp;#34;Kontaktdaten_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">542&lt;/span> &lt;span class="s2">&amp;#34;Benutzerdatenzugriff_*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">543&lt;/span> &lt;span class="s2">&amp;#34;Benutzerdatenspeicher _*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">544&lt;/span> &lt;span class="s2">&amp;#34;Radio Management Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">545&lt;/span> &lt;span class="s2">&amp;#34;Microsoft Edge-Update-Dienst (edgeupdate)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">546&lt;/span> &lt;span class="s2">&amp;#34;wuauserv&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">547&lt;/span> &lt;span class="s2">&amp;#34;Tracing Service for Search in Exchange&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">548&lt;/span> &lt;span class="s2">&amp;#34;Windows Defender Antivirus Network Inspection Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">549&lt;/span> &lt;span class="s2">&amp;#34;Windows Defender Antivirus Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">550&lt;/span> &lt;span class="s2">&amp;#34;Wired AutoConfig&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">551&lt;/span> &lt;span class="s2">&amp;#34;Microsoft-Softwareschattenkopie-Anbieter&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">552&lt;/span> &lt;span class="s2">&amp;#34;Diagnosediensthost&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">553&lt;/span> &lt;span class="s2">&amp;#34;Trend Micro Unauthorized Change Prevention Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">554&lt;/span> &lt;span class="s2">&amp;#34;Anwendungserfahrung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">555&lt;/span> &lt;span class="s2">&amp;#34;Anwendungsverwaltung&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">556&lt;/span> &lt;span class="s2">&amp;#34;Funktionssuchanbieter-Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">557&lt;/span> &lt;span class="s2">&amp;#34;Display Policy Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">558&lt;/span> &lt;span class="s2">&amp;#34;Device Management Wireless Application Protocol (WAP) Push message Routing Service&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">559&lt;/span> &lt;span class="s2">&amp;#34;WSUS Certificate Server&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="ln">560&lt;/span> &lt;span class="s2">&amp;#34;File Server Storage Reports Manager&amp;#34;&lt;/span>
&lt;span class="ln">561&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">562&lt;/span>
&lt;span class="ln">563&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">564&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">565&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;span class="ln">566&lt;/span>
&lt;span class="ln">567&lt;/span>&lt;span class="c">#region Initialization&lt;/span>
&lt;span class="ln">568&lt;/span>&lt;span class="c"># Import PRTG Module&lt;/span>
&lt;span class="ln">569&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nb">Get-Module&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="s2">&amp;#34;PrtgApi&amp;#34;&lt;/span> &lt;span class="n">-ErrorAction&lt;/span> &lt;span class="n">SilentlyContinue&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">570&lt;/span> &lt;span class="nb">Import-Module&lt;/span> &lt;span class="s2">&amp;#34;$env:workspace\Modules\PrtgApi&amp;#34;&lt;/span>
&lt;span class="ln">571&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">572&lt;/span>&lt;span class="c"># Teams Webhook URL (depending on if it is run in VSCode or as job)&lt;/span>
&lt;span class="ln">573&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$env:TERM_PROGRAM&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s1">&amp;#39;vscode&amp;#39;&lt;/span> &lt;span class="o">-and&lt;/span> &lt;span class="nv">$env:TeamsStagingURL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">574&lt;/span> &lt;span class="nv">$TeamsURL&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$env:TeamsStagingURL&lt;/span>
&lt;span class="ln">575&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">576&lt;/span> &lt;span class="nv">$TeamsURL&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$env:TeamsURL&lt;/span>
&lt;span class="ln">577&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">578&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;span class="ln">579&lt;/span>
&lt;span class="ln">580&lt;/span>&lt;span class="c">#region Functions&lt;/span>
&lt;span class="ln">581&lt;/span>&lt;span class="k">function&lt;/span> &lt;span class="nb">Send-TeamsMessage&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$facts&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$Theme&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s2">&amp;#34;Healthy&amp;#34;&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">582&lt;/span> &lt;span class="nv">$connectorUri&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$TeamsURL&lt;/span>
&lt;span class="ln">583&lt;/span> &lt;span class="nv">$Summary&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;PRTG Sensor Discovery &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$env:JOB_NAME&lt;/span>&lt;span class="p">){&lt;/span> &lt;span class="s2">&amp;#34;(Jenkins Job &amp;#39;$env:JOB_NAME&amp;#39;)&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="ln">584&lt;/span> &lt;span class="nv">$body&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="no">[ordered]&lt;/span>&lt;span class="p">@{&lt;/span>
&lt;span class="ln">585&lt;/span> &lt;span class="s2">&amp;#34;@type&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;MessageCard&amp;#34;&lt;/span>
&lt;span class="ln">586&lt;/span> &lt;span class="s2">&amp;#34;summary&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$Summary&lt;/span>
&lt;span class="ln">587&lt;/span> &lt;span class="s2">&amp;#34;themeColor&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">$(&lt;/span>
&lt;span class="ln">588&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$Theme&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToLower&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">Contains&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;error&amp;#34;&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">589&lt;/span> &lt;span class="s2">&amp;#34;#eb4034&amp;#34;&lt;/span>
&lt;span class="ln">590&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">591&lt;/span> &lt;span class="s2">&amp;#34;#a6a6a6&amp;#34;&lt;/span>
&lt;span class="ln">592&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">593&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">594&lt;/span> &lt;span class="s2">&amp;#34;sections&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln">595&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">596&lt;/span> &lt;span class="n">activityTitle&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$Summary&lt;/span>
&lt;span class="ln">597&lt;/span> &lt;span class="n">facts&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$facts&lt;/span>
&lt;span class="ln">598&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">599&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">600&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">601&lt;/span>
&lt;span class="ln">602&lt;/span> &lt;span class="nb">Invoke-RestMethod&lt;/span> &lt;span class="n">-Method&lt;/span> &lt;span class="n">post&lt;/span> &lt;span class="n">-ContentType&lt;/span> &lt;span class="s1">&amp;#39;Application/Json&amp;#39;&lt;/span> &lt;span class="n">-Body&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$body&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ConvertTo-Json&lt;/span> &lt;span class="n">-Depth&lt;/span> &lt;span class="n">5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">-Uri&lt;/span> &lt;span class="nv">$connectorUri&lt;/span>
&lt;span class="ln">603&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">604&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;span class="ln">605&lt;/span>
&lt;span class="ln">606&lt;/span>&lt;span class="c">#region Connection and Credentials&lt;/span>
&lt;span class="ln">607&lt;/span>&lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">608&lt;/span> &lt;span class="c"># Check if we&amp;#39;re connected&lt;/span>
&lt;span class="ln">609&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-PrtgStatus&lt;/span>
&lt;span class="ln">610&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">611&lt;/span> &lt;span class="c"># No, let&amp;#39;s connect.&lt;/span>
&lt;span class="ln">612&lt;/span>
&lt;span class="ln">613&lt;/span> &lt;span class="c"># Get Credentials&lt;/span>
&lt;span class="ln">614&lt;/span> &lt;span class="nv">$PRTGUsername&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$env:PRTGUsername&lt;/span>
&lt;span class="ln">615&lt;/span> &lt;span class="nv">$PRTGPassword&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$env:PRTGPassword&lt;/span>
&lt;span class="ln">616&lt;/span> &lt;span class="no">[securestring]&lt;/span>&lt;span class="nv">$secStringPassword&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">ConvertTo-SecureString&lt;/span> &lt;span class="nv">$PRTGPassword&lt;/span> &lt;span class="n">-AsPlainText&lt;/span> &lt;span class="n">-Force&lt;/span>
&lt;span class="ln">617&lt;/span> &lt;span class="no">[pscredential]&lt;/span>&lt;span class="nv">$creds&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-Object&lt;/span> &lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Management&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Automation&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PSCredential&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$PRTGUsername&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$secStringPassword&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">618&lt;/span>
&lt;span class="ln">619&lt;/span> &lt;span class="c"># Connect&lt;/span>
&lt;span class="ln">620&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Connect-PrtgServer&lt;/span> &lt;span class="n">-Server&lt;/span> &lt;span class="nv">$env:PRTGUrl&lt;/span> &lt;span class="n">-Credential&lt;/span> &lt;span class="nv">$creds&lt;/span> &lt;span class="n">-Force&lt;/span>
&lt;span class="ln">621&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">622&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;span class="ln">623&lt;/span>
&lt;span class="ln">624&lt;/span>&lt;span class="c">#region Processing&lt;/span>
&lt;span class="ln">625&lt;/span>&lt;span class="nv">$addedSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln">626&lt;/span>&lt;span class="nv">$hasError&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln">627&lt;/span>&lt;span class="nv">$RegistryBasePath&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Registry::HKEY_CURRENT_USER\SOFTWARE\PRTGDiscovery&amp;#34;&lt;/span>
&lt;span class="ln">628&lt;/span>&lt;span class="nv">$RegistryLastDiscovery&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;$RegistryBasePath\LastScan&amp;#34;&lt;/span>
&lt;span class="ln">629&lt;/span>
&lt;span class="ln">630&lt;/span>&lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">631&lt;/span> &lt;span class="nv">$servicesAdded&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln">632&lt;/span> &lt;span class="nv">$SensorTypes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetEnumerator&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">633&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">634&lt;/span> &lt;span class="nv">$SensorType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">635&lt;/span> &lt;span class="nv">$ignoredServices&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExclusionList&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ToLower&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">636&lt;/span>
&lt;span class="ln">637&lt;/span> &lt;span class="c"># Get Services for the device&lt;/span>
&lt;span class="ln">638&lt;/span> &lt;span class="nv">$services&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Device&lt;/span> &lt;span class="n">-Group&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nb">Group &lt;/span>&lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">NameFilter&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">639&lt;/span> &lt;span class="nv">$device&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">640&lt;/span> &lt;span class="nv">$LastDiscoveryInterval&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">4&lt;/span>
&lt;span class="ln">641&lt;/span>
&lt;span class="ln">642&lt;/span> &lt;span class="c"># Check if the registry hive is there&lt;/span>
&lt;span class="ln">643&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nb">Test-Path&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="nv">$RegistryLastDiscovery&lt;/span> &lt;span class="n">-ErrorAction&lt;/span> &lt;span class="n">SilentlyContinue&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">644&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Creating registry path &lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2">$RegistryLastDiscovery&lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2">..&amp;#34;&lt;/span>
&lt;span class="ln">645&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-Item&lt;/span> &lt;span class="n">-ItemType&lt;/span> &lt;span class="n">Directory&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="nv">$RegistryLastDiscovery&lt;/span> &lt;span class="n">-Force&lt;/span>
&lt;span class="ln">646&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">647&lt;/span> &lt;span class="nv">$stateName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="ln">648&lt;/span>
&lt;span class="ln">649&lt;/span> &lt;span class="c"># Check if our check is due or if we skip that one&lt;/span>
&lt;span class="ln">650&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">651&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-ItemProperty&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="nv">$RegistryLastDiscovery&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nv">$stateName&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">652&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$LastState&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-ItemPropertyValue&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="nv">$RegistryLastDiscovery&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$stateName&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">653&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$LastStateDate&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="no">[datetime]&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="n">ParseExact&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$LastState&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;yyyyMMddHHmmss&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$null&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">654&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-Date&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-lt&lt;/span> &lt;span class="nv">$LastStateDate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AddHours&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$LastDiscoveryInterval&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">655&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">656&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] Skipping as last discovery was &lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2">$LastStateDate&lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2"> and it is due at &lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$LastStateDate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AddHours&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$LastDiscoveryThreshold&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2">..&amp;#34;&lt;/span>
&lt;span class="ln">657&lt;/span> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">658&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">659&lt;/span>
&lt;span class="ln">660&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] Searching for sensors..&amp;#34;&lt;/span>
&lt;span class="ln">661&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">662&lt;/span> &lt;span class="c"># Null our previous vars out&lt;/span>
&lt;span class="ln">663&lt;/span> &lt;span class="nv">$sensormeta&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$null&lt;/span>
&lt;span class="ln">664&lt;/span>
&lt;span class="ln">665&lt;/span> &lt;span class="c"># Build our parameters dynamically for Splatting&lt;/span>
&lt;span class="ln">666&lt;/span> &lt;span class="nv">$params&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">667&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RawType&lt;/span>
&lt;span class="ln">668&lt;/span> &lt;span class="n">ErrorAction&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;Stop&amp;#39;&lt;/span>
&lt;span class="ln">669&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">670&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">671&lt;/span> &lt;span class="nv">$params&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>
&lt;span class="ln">672&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">673&lt;/span>
&lt;span class="ln">674&lt;/span> &lt;span class="c"># Query the device for SNMP Sensors based on our Template&lt;/span>
&lt;span class="ln">675&lt;/span> &lt;span class="nb">Set-ItemProperty&lt;/span> &lt;span class="n">-Path&lt;/span> &lt;span class="nv">$RegistryLastDiscovery&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$stateName&lt;/span> &lt;span class="n">-Value&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-Date&lt;/span> &lt;span class="n">-Format&lt;/span> &lt;span class="s2">&amp;#34;yyyyMMddHHmmss&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">676&lt;/span> &lt;span class="nv">$sensormeta&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Device&lt;/span> &lt;span class="n">-Id&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Id&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">New-SensorParameters&lt;/span> &lt;span class="nv">@params&lt;/span>
&lt;span class="ln">677&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] Finished searching for sensors..&amp;#34;&lt;/span>
&lt;span class="ln">678&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">679&lt;/span> &lt;span class="nb">Write-Verbose&lt;/span> &lt;span class="n">-Message&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] Failed to get SNMP sensors: $_&amp;#34;&lt;/span>
&lt;span class="ln">680&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">681&lt;/span>
&lt;span class="ln">682&lt;/span> &lt;span class="c"># Filter Services for actual application services&lt;/span>
&lt;span class="ln">683&lt;/span> &lt;span class="nv">$servicesToMonitor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln">684&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">685&lt;/span> &lt;span class="nv">$sensormeta&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">686&lt;/span> &lt;span class="nv">$sensormeta&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Targets&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">687&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$attr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AttributeName&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">688&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$sTargets&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$sensormeta&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Targets&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nv">$attr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">689&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">690&lt;/span> &lt;span class="c"># Loop through the sensors&lt;/span>
&lt;span class="ln">691&lt;/span> &lt;span class="nv">$sTargets&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Foreach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">692&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">NameExtractionSB&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">693&lt;/span> &lt;span class="nv">$serviceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;\\&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;\&amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">ToLower&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">694&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">695&lt;/span> &lt;span class="c"># Cast &amp;#34;t&amp;#34; as var for the device to be used in the scriptblock&lt;/span>
&lt;span class="ln">696&lt;/span> &lt;span class="nv">$t&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">697&lt;/span>
&lt;span class="ln">698&lt;/span> &lt;span class="c"># Invoke the scriptblock&lt;/span>
&lt;span class="ln">699&lt;/span> &lt;span class="nv">$serviceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">NameExtractionSB&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Invoke&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">700&lt;/span>
&lt;span class="ln">701&lt;/span> &lt;span class="c"># Overwrite it in the hashtable so we can pass the extracted name&lt;/span>
&lt;span class="ln">702&lt;/span> &lt;span class="nv">$_&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Add-Member&lt;/span> &lt;span class="n">-Type&lt;/span> &lt;span class="n">NoteProperty&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="s2">&amp;#34;Name&amp;#34;&lt;/span> &lt;span class="n">-Value&lt;/span> &lt;span class="nv">$serviceName&lt;/span> &lt;span class="n">-Force&lt;/span>
&lt;span class="ln">703&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">704&lt;/span>
&lt;span class="ln">705&lt;/span> &lt;span class="c"># Get service name with device name prefix so we can exclude based on specific devices&lt;/span>
&lt;span class="ln">706&lt;/span> &lt;span class="nv">$serviceNameWithDeviceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">\&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$serviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;\\&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;\&amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">ToLower&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">707&lt;/span>
&lt;span class="ln">708&lt;/span> &lt;span class="c"># Verify if the sensors are not excluded&lt;/span>
&lt;span class="ln">709&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$ignoredServices&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">710&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$serviceName&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-or&lt;/span>
&lt;span class="ln">711&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$serviceNameWithDeviceName&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">712&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">713&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">714&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">715&lt;/span> &lt;span class="nv">$servicesToMonitor&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">716&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">717&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">718&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">719&lt;/span> &lt;span class="c"># This device has no sensors based on our Sensor Type&lt;/span>
&lt;span class="ln">720&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] Has no SNMP Service sensors.&amp;#34;&lt;/span>
&lt;span class="ln">721&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">722&lt;/span>
&lt;span class="ln">723&lt;/span> &lt;span class="c"># Build the return object &lt;/span>
&lt;span class="ln">724&lt;/span> &lt;span class="no">[PSCustomObject]&lt;/span>&lt;span class="p">@{&lt;/span>
&lt;span class="ln">725&lt;/span> &lt;span class="n">DeviceID&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Id&lt;/span>
&lt;span class="ln">726&lt;/span> &lt;span class="n">DeviceParentID&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ParentId&lt;/span>
&lt;span class="ln">727&lt;/span> &lt;span class="n">DeviceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln">728&lt;/span> &lt;span class="n">Services&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$servicesToMonitor&lt;/span>
&lt;span class="ln">729&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">730&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">731&lt;/span>
&lt;span class="ln">732&lt;/span> &lt;span class="c"># Look through all detected services and add the sensors&lt;/span>
&lt;span class="ln">733&lt;/span> &lt;span class="nv">$services&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Services&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">734&lt;/span> &lt;span class="c"># Get the devices&lt;/span>
&lt;span class="ln">735&lt;/span> &lt;span class="nv">$device&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Device&lt;/span> &lt;span class="n">-Id&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceId&lt;/span>
&lt;span class="ln">736&lt;/span>
&lt;span class="ln">737&lt;/span> &lt;span class="c"># Get the devices&amp;#39; sensors&lt;/span>
&lt;span class="ln">738&lt;/span> &lt;span class="nv">$sensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Get-Sensor&lt;/span>
&lt;span class="ln">739&lt;/span>
&lt;span class="ln">740&lt;/span> &lt;span class="c"># Save our current object&lt;/span>
&lt;span class="ln">741&lt;/span> &lt;span class="nv">$deviceObj&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">742&lt;/span>
&lt;span class="ln">743&lt;/span> &lt;span class="nv">$servicesToAdd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln">744&lt;/span> &lt;span class="c"># Loop through the services&lt;/span>
&lt;span class="ln">745&lt;/span> &lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Services&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">746&lt;/span> &lt;span class="c"># Get the new prefix&lt;/span>
&lt;span class="ln">747&lt;/span> &lt;span class="nv">$sensorPrefix&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorPrefix&lt;/span>
&lt;span class="ln">748&lt;/span> &lt;span class="nv">$normalizedName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">Replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;\\&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;\&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">749&lt;/span> &lt;span class="c"># Build the new sensor name and normalize it so we don&amp;#39;t accidently create two sensors just because one messed up at creating&lt;/span>
&lt;span class="ln">750&lt;/span> &lt;span class="nv">$newSensorname&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;$sensorPrefix $normalizedName&amp;#34;&lt;/span>
&lt;span class="ln">751&lt;/span>
&lt;span class="ln">752&lt;/span> &lt;span class="c"># Check if the sensor already exists&lt;/span>
&lt;span class="ln">753&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">754&lt;/span> &lt;span class="nv">$sensors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">755&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$newSensorname&lt;/span> &lt;span class="n">-in&lt;/span> &lt;span class="nv">$sensors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="ln">756&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">757&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Green&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: $newSensorname exists.&amp;#34;&lt;/span>
&lt;span class="ln">758&lt;/span>
&lt;span class="ln">759&lt;/span> &lt;span class="c"># No it doesn&amp;#39;t -&amp;gt; create it&lt;/span>
&lt;span class="ln">760&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">761&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: $newSensorname adding to process table..&amp;#34;&lt;/span>
&lt;span class="ln">762&lt;/span> &lt;span class="nv">$params&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">763&lt;/span> &lt;span class="n">RawType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RawType&lt;/span>
&lt;span class="ln">764&lt;/span> &lt;span class="n">ErrorAction&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;Stop&amp;#39;&lt;/span>
&lt;span class="ln">765&lt;/span> &lt;span class="n">Target&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">766&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">767&lt;/span>
&lt;span class="ln">768&lt;/span> &lt;span class="c"># Check if we got additional QueryParameters and add them to our Splatting&lt;/span>
&lt;span class="ln">769&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">770&lt;/span> &lt;span class="nv">$params&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>
&lt;span class="ln">771&lt;/span> &lt;span class="c"># Timeout requires an extra switch, if it is set, set it here also&lt;/span>
&lt;span class="ln">772&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s1">&amp;#39;timeout_&amp;#39;&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">773&lt;/span> &lt;span class="nv">$params&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Timeout&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s1">&amp;#39;timeout_&amp;#39;&lt;/span>
&lt;span class="ln">774&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">775&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">776&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">777&lt;/span> &lt;span class="c"># Create SensorParameter Object based on device&lt;/span>
&lt;span class="ln">778&lt;/span> &lt;span class="nv">$sParam&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">New-SensorParameters&lt;/span> &lt;span class="nv">@params&lt;/span>
&lt;span class="ln">779&lt;/span>
&lt;span class="ln">780&lt;/span> &lt;span class="c"># Dynamically add the timeout once more&lt;/span>
&lt;span class="ln">781&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$params&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Timeout&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">782&lt;/span> &lt;span class="c"># Add Timeout Switch if set - there seems to be a bug in the module so it does not inherit the one we set earlier, this would generate errors for NetApp cDOT Sensors &lt;/span>
&lt;span class="ln">783&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">784&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">785&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s1">&amp;#39;timeout_&amp;#39;&lt;/span>
&lt;span class="ln">786&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">787&lt;/span> &lt;span class="c"># We need to unlock the object before adding custom parameters to it&lt;/span>
&lt;span class="ln">788&lt;/span> &lt;span class="nv">$sParam&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Unlock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">789&lt;/span> &lt;span class="c"># Set the timeout&lt;/span>
&lt;span class="ln">790&lt;/span> &lt;span class="nv">$sParam&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">timeout&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">QueryParameters&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s1">&amp;#39;timeout_&amp;#39;&lt;/span>
&lt;span class="ln">791&lt;/span> &lt;span class="c"># Lock it again&lt;/span>
&lt;span class="ln">792&lt;/span> &lt;span class="nv">$sParam&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Lock&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="ln">793&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">794&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">795&lt;/span>
&lt;span class="ln">796&lt;/span> &lt;span class="c"># Add the actual sensor to our process list&lt;/span>
&lt;span class="ln">797&lt;/span> &lt;span class="nv">$servicesToAdd&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">798&lt;/span> &lt;span class="n">SensorParams&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$sParam&lt;/span>
&lt;span class="ln">799&lt;/span> &lt;span class="n">SensorType&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln">800&lt;/span> &lt;span class="n">SensorDeviceName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln">801&lt;/span> &lt;span class="n">SensorFriendlyName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$device&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">] $normalizedName&amp;#34;&lt;/span>
&lt;span class="ln">802&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">803&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: $newSensorname added to process table.&amp;#34;&lt;/span>
&lt;span class="ln">804&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">805&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: $newSensorname failed to create: $_&amp;#34;&lt;/span>
&lt;span class="ln">806&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">807&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">808&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">809&lt;/span>
&lt;span class="ln">810&lt;/span> &lt;span class="c"># Process new sensors&lt;/span>
&lt;span class="ln">811&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$servicesToAdd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Count&lt;/span> &lt;span class="o">-gt&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">812&lt;/span> &lt;span class="c"># Check if we have to add too many sensors&lt;/span>
&lt;span class="ln">813&lt;/span> &lt;span class="nv">$MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">10&lt;/span>
&lt;span class="ln">814&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">MaxSensors&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">815&lt;/span> &lt;span class="nv">$MaxSensors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Value&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">MaxSensors&lt;/span>
&lt;span class="ln">816&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">817&lt;/span>
&lt;span class="ln">818&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$servicesToAdd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Count&lt;/span> &lt;span class="o">-gt&lt;/span> &lt;span class="nv">$MaxSensors&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">819&lt;/span> &lt;span class="nv">$lError&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: has over $MaxSensors Sensors to add, please review - skipping for now.&amp;#34;&lt;/span>
&lt;span class="ln">820&lt;/span> &lt;span class="nv">$hasError&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">821&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">822&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">823&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: Processing new Sensors..&amp;#34;&lt;/span>
&lt;span class="ln">824&lt;/span> &lt;span class="nv">$servicesToAdd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetEnumerator&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">825&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: adding &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorFriendlyName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">..&amp;#34;&lt;/span>
&lt;span class="ln">826&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">827&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorParams&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Add-Sensor&lt;/span> &lt;span class="n">-ErrorAction&lt;/span> &lt;span class="n">Stop&lt;/span>
&lt;span class="ln">828&lt;/span> &lt;span class="nv">$addedSensors&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln">829&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorType&lt;/span>
&lt;span class="ln">830&lt;/span> &lt;span class="n">value&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorFriendlyName&lt;/span>
&lt;span class="ln">831&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">832&lt;/span> &lt;span class="nv">$servicesAdded&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">833&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">834&lt;/span> &lt;span class="nv">$lError&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$deviceObj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: Failed adding &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorFriendlyName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InvocationInfo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ScriptLineNumber&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Exception&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="ln">835&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">836&lt;/span> &lt;span class="nv">$hasError&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">837&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">838&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">839&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">840&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">841&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">842&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">843&lt;/span> &lt;span class="nv">$lError&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Failed at Sensor Type: &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$SensorType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">, Error in line &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InvocationInfo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ScriptLineNumber&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Exception&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="ln">844&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">845&lt;/span> &lt;span class="nv">$hasError&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">846&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">847&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">848&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">849&lt;/span> &lt;span class="nv">$lError&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Failed to discover! Error in line &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">InvocationInfo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ScriptLineNumber&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Exception&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Message&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="ln">850&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">851&lt;/span> &lt;span class="nv">$hasError&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$lError&lt;/span>
&lt;span class="ln">852&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="k">finally&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">853&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">854&lt;/span> &lt;span class="nv">$addedSensors&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">855&lt;/span> &lt;span class="nv">$addedSensors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Count&lt;/span> &lt;span class="o">-gt&lt;/span> &lt;span class="n">0&lt;/span>
&lt;span class="ln">856&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">857&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Green&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Summary:&amp;#34;&lt;/span>
&lt;span class="ln">858&lt;/span> &lt;span class="nv">$servicesAdded&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetEnumerator&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">859&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Green&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorDeviceName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: added &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SensorFriendlyName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">..&amp;#34;&lt;/span>
&lt;span class="ln">860&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">861&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$TeamsURL&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">862&lt;/span> &lt;span class="nb">Send-TeamsMessage&lt;/span> &lt;span class="n">-Facts&lt;/span> &lt;span class="nv">$addedSensors&lt;/span>
&lt;span class="ln">863&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">864&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">865&lt;/span>
&lt;span class="ln">866&lt;/span> &lt;span class="c"># Cleanup orphaned Windows Service sensors, this happens from time to time during service discovery unfortunately&lt;/span>
&lt;span class="ln">867&lt;/span> &lt;span class="c"># Those sensors can be identified by their Name &amp;#34;Service &amp;#34; and their type of snmpservice - however they do not work as they don&amp;#39;t get an OID&lt;/span>
&lt;span class="ln">868&lt;/span> &lt;span class="k">try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">869&lt;/span> &lt;span class="nv">$cleanup&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Sensor&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="s2">&amp;#34;Service &amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Type&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">StringValue&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;snmpservice&amp;#34;&lt;/span> &lt;span class="o">-and&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;Service &amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">870&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$cleanup&lt;/span> &lt;span class="o">-and&lt;/span> &lt;span class="nv">$cleanup&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Count&lt;/span> &lt;span class="o">-gt&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">871&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Cleaning up orphaned SNMP Service sensors..&amp;#34;&lt;/span>
&lt;span class="ln">872&lt;/span> &lt;span class="nv">$cleanup&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">873&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;[&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Device&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">]: Cleaning up orphaned SNMP Service sensors..&amp;#34;&lt;/span>
&lt;span class="ln">874&lt;/span> &lt;span class="nv">$_&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Remove-Object&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span> &lt;span class="n">-Force&lt;/span>
&lt;span class="ln">875&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">876&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">877&lt;/span> &lt;span class="p">}&lt;/span>&lt;span class="k">catch&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="ln">878&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Yellow&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Error at cleaning up orphaned SNMP Service sensors! Error: $_&amp;#34;&lt;/span>
&lt;span class="ln">879&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">880&lt;/span>
&lt;span class="ln">881&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$hasError&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Count&lt;/span> &lt;span class="o">-gt&lt;/span> &lt;span class="n">0&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">882&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Errors detected, please review the following lines!&amp;#34;&lt;/span>
&lt;span class="ln">883&lt;/span> &lt;span class="nv">$hasError&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">884&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-ForegroundColor&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">885&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">886&lt;/span> &lt;span class="n">exit&lt;/span> &lt;span class="n">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">887&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">888&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">889&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>PowerShell NetApp SnapMirror Destination Migration</title><link>https://system32.blog/post/netappsnapmirrorposhmigration/</link><pubDate>Mon, 23 Aug 2021 00:00:00 +0000</pubDate><guid>https://system32.blog/post/netappsnapmirrorposhmigration/</guid><description>
&lt;p>This article shows how to use PowerShell and the NetApp PowerShell Module to migrate all NetApp SnapVault/SnapMirror relationships to a new system.
The script also builds the SVM Relationships and does the cutovers of the relationships on the source ONTAP Systems.&lt;/p>
&lt;p>&lt;code>Disclaimer: This content and scripts are provided free of charge and I do not take any responsability for them nor any harm they may cause, it is up to you to review and test them properly before deploying them anywhere.&lt;/code>&lt;/p>
&lt;h1 id="introduction">Introduction&lt;/h1>
&lt;p>If you ever had to migrate a SnapMirror Destination ONTAP System to a new one, you probably already faced the struggle to migrate Volume by Volume and SnapMirror by SnapMirror to keep all Snapshots.&lt;/p>
&lt;p>The good news: You don't have to do this manually as NetApp has a great PowerShell integration for both, ONTAP and 7-Mode Systems.&lt;/p>
&lt;h1 id="the-magic">The magic&lt;/h1>
&lt;p>Since I had to migrate multiple SnapMirror Destination ONTAP Clusters to new ones and realized how much effort this is per volume, I came up with this PowerShell script to automate this process.&lt;/p>
&lt;p>What this script does is:&lt;/p>
&lt;ul>
&lt;li>SVM Peering&lt;/li>
&lt;li>Volume creation&lt;/li>
&lt;li>Intermediate SnapMirror Relationship and Initialization&lt;/li>
&lt;li>Cutover on the Source Systems from the old SnapMirror Destination over to new SnapMirror Destination (keeping the existing policy, schedule and settings)&lt;/li>
&lt;li>Break-up off the existing SnapMirror from Source Systems to the old Destination System&lt;/li>
&lt;/ul>
&lt;p>Prerequisites:&lt;/p>
&lt;ul>
&lt;li>Credentials for all involved ONTAP Systems&lt;/li>
&lt;li>Cluster Peering between old destination system and new destination system&lt;/li>
&lt;li>Cluster Peering between source systems and new destination systems&lt;/li>
&lt;li>SnapMirror Policies, Schedules and Snapshot Labels from all source storages pre-created on the new destination system (the script will not create them)&lt;/li>
&lt;/ul>
&lt;h1 id="how-to-use-it">How to use it&lt;/h1>
&lt;p>To use the script, simply fill in the variables at the start of the script, please make sure to cross check all information you enter.
On the first run, it will ask you for credentials for both, the old and the new destination system. After that, it will create the SVM Peerings (if not existent), the volumes and the SnapMirrors between the old and new destination system and initialize them.&lt;/p>
&lt;p>It will take some time (hours to weeks) to transfer the data in those volumes between the old destination and the new destination systems depending on both systems performance and the amount of data.&lt;/p>
&lt;p>You can check the status on the new destination system by executing &lt;code>snapmirror show&lt;/code> and verifying that the status is &lt;code>snapmirrored&lt;/code> and &lt;code>idle&lt;/code>.&lt;/p>
&lt;p>As soon as that's the case, run the script once more. It will start by fetching the status then quiescing, breaking and deleting the mirrors to the old backup system and ask you for credentials to all involved source systems. After entering the credentials, it will start to build the SnapMirror Relationships from the source system to the new destination system, invoke a resync and release the SnapMirror to the old backup system.&lt;/p>
&lt;h1 id="the-script">The script&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-PowerShell" data-lang="PowerShell">&lt;span class="ln"> 1&lt;/span>&lt;span class="c">#region Variables&lt;/span>
&lt;span class="ln"> 2&lt;/span>&lt;span class="nv">$oldIP&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;Management IP of old destination storage&amp;gt;&amp;#34;&lt;/span>
&lt;span class="ln"> 3&lt;/span>&lt;span class="nv">$newIP&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;Management IP of new destination storage&amp;gt;&amp;#34;&lt;/span>
&lt;span class="ln"> 4&lt;/span>
&lt;span class="ln"> 5&lt;/span>&lt;span class="no">[array]&lt;/span>&lt;span class="nv">$svms&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@(&lt;/span>
&lt;span class="ln"> 6&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 7&lt;/span> &lt;span class="n">Old&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;SVM Name on old destination storage&amp;gt;&amp;#34;&lt;/span>
&lt;span class="ln"> 8&lt;/span> &lt;span class="n">New&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;SVM Name on new destination storage&amp;gt;&amp;#34;&lt;/span>
&lt;span class="ln"> 9&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 10&lt;/span> &lt;span class="cm">&amp;lt;#
&lt;/span>&lt;span class="ln"> 11&lt;/span>&lt;span class="cm"> Add as many SVMs as required
&lt;/span>&lt;span class="ln"> 12&lt;/span>&lt;span class="cm"> @{
&lt;/span>&lt;span class="ln"> 13&lt;/span>&lt;span class="cm"> Old = &amp;#34;&amp;lt;SVM Name on old destination storage&amp;gt;&amp;#34;
&lt;/span>&lt;span class="ln"> 14&lt;/span>&lt;span class="cm"> New = &amp;#34;&amp;lt;SVM Name on new destination storage&amp;gt;&amp;#34;
&lt;/span>&lt;span class="ln"> 15&lt;/span>&lt;span class="cm"> }
&lt;/span>&lt;span class="ln"> 16&lt;/span>&lt;span class="cm"> #&amp;gt;&lt;/span>
&lt;span class="ln"> 17&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 18&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;span class="ln"> 19&lt;/span>
&lt;span class="ln"> 20&lt;/span>&lt;span class="c">#region Code below&lt;/span>
&lt;span class="ln"> 21&lt;/span>
&lt;span class="ln"> 22&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$oldCreds&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 23&lt;/span> &lt;span class="nv">$oldCreds&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Credential&lt;/span> &lt;span class="n">-Message&lt;/span> &lt;span class="s2">&amp;#34;Old System&amp;#34;&lt;/span>
&lt;span class="ln"> 24&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 25&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$newCreds&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 26&lt;/span> &lt;span class="nv">$newCreds&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Credential&lt;/span> &lt;span class="n">-Message&lt;/span> &lt;span class="s2">&amp;#34;New System&amp;#34;&lt;/span>
&lt;span class="ln"> 27&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 28&lt;/span>
&lt;span class="ln"> 29&lt;/span>&lt;span class="nv">$oldCluster&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Connect-NcController&lt;/span> &lt;span class="n">-HTTPS&lt;/span> &lt;span class="n">-Credential&lt;/span> &lt;span class="nv">$oldCreds&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$oldIP&lt;/span>
&lt;span class="ln"> 30&lt;/span>&lt;span class="nv">$newCluster&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Connect-NcController&lt;/span> &lt;span class="n">-HTTPS&lt;/span> &lt;span class="n">-Credential&lt;/span> &lt;span class="nv">$newCreds&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$newIP&lt;/span>
&lt;span class="ln"> 31&lt;/span>
&lt;span class="ln"> 32&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-NcCluster&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">ClusterName&lt;/span>
&lt;span class="ln"> 33&lt;/span>&lt;span class="nv">$newClusterName&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-NcCluster&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">ClusterName&lt;/span>
&lt;span class="ln"> 34&lt;/span>
&lt;span class="ln"> 35&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$CredentialTable&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 36&lt;/span> &lt;span class="nv">$CredentialTable&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{}&lt;/span>
&lt;span class="ln"> 37&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 38&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$IPTable&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 39&lt;/span> &lt;span class="nv">$IPTable&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{}&lt;/span>
&lt;span class="ln"> 40&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 41&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!&lt;/span>&lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 42&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@{}&lt;/span>
&lt;span class="ln"> 43&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 44&lt;/span>
&lt;span class="ln"> 45&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$calculatedBlacklist&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln"> 46&lt;/span> &lt;span class="nv">$calculatedBlacklist&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln"> 47&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln"> 48&lt;/span>
&lt;span class="ln"> 49&lt;/span>&lt;span class="nv">$svms&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetEnumerator&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln"> 50&lt;/span>
&lt;span class="ln"> 51&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Old&lt;/span>
&lt;span class="ln"> 52&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">New&lt;/span>
&lt;span class="ln"> 53&lt;/span>
&lt;span class="ln"> 54&lt;/span> &lt;span class="nv">$OldSVMObj&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVserver&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span>
&lt;span class="ln"> 55&lt;/span>
&lt;span class="ln"> 56&lt;/span> &lt;span class="c"># Check if Destination SVM Exists&lt;/span>
&lt;span class="ln"> 57&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$NewSVMObj&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVserver&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$newSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln"> 58&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Creating new vServer $newSVM on $newClusterName&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 59&lt;/span> &lt;span class="nv">$aggr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-NcAggr&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Sort-Object&lt;/span> &lt;span class="n">-Property&lt;/span> &lt;span class="n">Available&lt;/span> &lt;span class="n">-Descending&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln"> 60&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-NcVserver&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="p">`&lt;/span>
&lt;span class="ln"> 61&lt;/span> &lt;span class="n">-RootVolumeAggregate&lt;/span> &lt;span class="nv">$aggr&lt;/span> &lt;span class="p">`&lt;/span>
&lt;span class="ln"> 62&lt;/span> &lt;span class="n">-RootVolumeSecurityStyle&lt;/span> &lt;span class="nv">$oldsvmobj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RootVolumeSecurityStyle&lt;/span> &lt;span class="p">`&lt;/span>
&lt;span class="ln"> 63&lt;/span> &lt;span class="n">-Language&lt;/span> &lt;span class="nv">$oldsvmobj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Language&lt;/span> &lt;span class="p">`&lt;/span>
&lt;span class="ln"> 64&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln"> 65&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 66&lt;/span>
&lt;span class="ln"> 67&lt;/span> &lt;span class="c"># Check if Destination SVM is peered with source vserver&lt;/span>
&lt;span class="ln"> 68&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$peerrelationship&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="n">-Application&lt;/span> &lt;span class="s2">&amp;#34;snapmirror&amp;#34;&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln"> 69&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Creating new vServer Peer Relationship for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 70&lt;/span> &lt;span class="nv">$peerrelationship&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="n">-Application&lt;/span> &lt;span class="s2">&amp;#34;snapmirror&amp;#34;&lt;/span> &lt;span class="n">-PeerCluster&lt;/span> &lt;span class="nv">$newClusterName&lt;/span>
&lt;span class="ln"> 71&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 72&lt;/span>
&lt;span class="ln"> 73&lt;/span> &lt;span class="c"># Check if SVM Peer is unitialized&lt;/span>
&lt;span class="ln"> 74&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$peerrelationship&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerState&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;initiated&amp;#34;&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln"> 75&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Confirming new vServer Peer Relationship for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 76&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Confirm-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln"> 77&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 78&lt;/span>
&lt;span class="ln"> 79&lt;/span> &lt;span class="c"># Get existing volumes&lt;/span>
&lt;span class="ln"> 80&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Getting volumes for $oldSVM on $oldClusterName&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 81&lt;/span> &lt;span class="nv">$vols&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">@()&lt;/span>
&lt;span class="ln"> 82&lt;/span> &lt;span class="nb">Get-NcVol&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="o">-notlike&lt;/span> &lt;span class="s2">&amp;#34;*root*&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln"> 83&lt;/span> &lt;span class="nv">$vols&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="p">@{&lt;/span>
&lt;span class="ln"> 84&lt;/span> &lt;span class="n">Size&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">TotalSize&lt;/span>
&lt;span class="ln"> 85&lt;/span> &lt;span class="n">Language&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">VolumeLanguageAttributes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">LanguageCode&lt;/span>
&lt;span class="ln"> 86&lt;/span> &lt;span class="n">Name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln"> 87&lt;/span> &lt;span class="n">Security&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">VolumeSecurityAttributes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Style&lt;/span>
&lt;span class="ln"> 88&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 89&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln"> 90&lt;/span>
&lt;span class="ln"> 91&lt;/span> &lt;span class="c"># Run through volumes &lt;/span>
&lt;span class="ln"> 92&lt;/span> &lt;span class="nv">$vols&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetEnumerator&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln"> 93&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-notin&lt;/span> &lt;span class="nv">$calculatedBlacklist&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln"> 94&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-notin&lt;/span> &lt;span class="nv">$volumeBlacklist&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln"> 95&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ForEach-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln"> 96&lt;/span> &lt;span class="c"># Create new volume if it doesn&amp;#39;t exist&lt;/span>
&lt;span class="ln"> 97&lt;/span> &lt;span class="nv">$aggr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Get-NcAggr&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Sort-Object&lt;/span> &lt;span class="n">-Property&lt;/span> &lt;span class="n">Available&lt;/span> &lt;span class="n">-Descending&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="n">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln"> 98&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$volume&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVol&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln"> 99&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Creating new volume &lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="se">`&amp;#34;&lt;/span>&lt;span class="s2"> for $newSVM on $newClusterName&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">100&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-NcVol&lt;/span> &lt;span class="n">-Size&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Size&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Language&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Language&lt;/span> &lt;span class="n">-SecurityStyle&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Security&lt;/span> &lt;span class="n">-VserverContext&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Aggregate&lt;/span> &lt;span class="nv">$aggr&lt;/span> &lt;span class="n">-Type&lt;/span> &lt;span class="n">dp&lt;/span> &lt;span class="n">-JunctionActive&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span> &lt;span class="n">-JunctionPath&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln">101&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">102&lt;/span>
&lt;span class="ln">103&lt;/span> &lt;span class="c"># Create new snapmirror if it doesn&amp;#39;t exist&lt;/span>
&lt;span class="ln">104&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcSnapmirror&lt;/span> &lt;span class="n">-SourceCluster&lt;/span> &lt;span class="nv">$oldClusterName&lt;/span> &lt;span class="n">-SourceVserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-SourceVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-DestinationCluster&lt;/span> &lt;span class="nv">$newClusterName&lt;/span> &lt;span class="n">-DestinationVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-DestinationVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">105&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Creating new snapmirror from &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">106&lt;/span> &lt;span class="nv">$snapmirror&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-NcSnapmirror&lt;/span> &lt;span class="n">-SourceCluster&lt;/span> &lt;span class="nv">$oldClusterName&lt;/span> &lt;span class="n">-SourceVserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-SourceVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-DestinationCluster&lt;/span> &lt;span class="nv">$newClusterName&lt;/span> &lt;span class="n">-DestinationVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-DestinationVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Schedule&lt;/span> &lt;span class="s2">&amp;#34;hourly&amp;#34;&lt;/span> &lt;span class="n">-Policy&lt;/span> &lt;span class="s2">&amp;#34;MirrorAllSnapshots&amp;#34;&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln">107&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">108&lt;/span>
&lt;span class="ln">109&lt;/span> &lt;span class="c"># Initialize new snapmirror if not done yet&lt;/span>
&lt;span class="ln">110&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">111&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">MirrorState&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;uninitialized&amp;#34;&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">112&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Status&lt;/span> &lt;span class="o">-ne&lt;/span> &lt;span class="s2">&amp;#34;transferring&amp;#34;&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">113&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Status&lt;/span> &lt;span class="o">-ne&lt;/span> &lt;span class="s2">&amp;#34;finalizing&amp;#34;&lt;/span>
&lt;span class="ln">114&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">115&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Initializing new snapmirror from &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">116&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorInitialize&lt;/span> &lt;span class="n">-SourceCluster&lt;/span> &lt;span class="nv">$oldClusterName&lt;/span> &lt;span class="n">-SourceVserver&lt;/span> &lt;span class="nv">$OldSVM&lt;/span> &lt;span class="n">-SourceVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-DestinationCluster&lt;/span> &lt;span class="nv">$newClusterName&lt;/span> &lt;span class="n">-DestinationVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-DestinationVolume&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln">117&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">118&lt;/span>
&lt;span class="ln">119&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="ln">120&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">MirrorState&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;snapmirrored&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">121&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">status&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;idle&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">122&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">IsHealthy&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">123&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$oldSnapmirror&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcSnapmirror&lt;/span> &lt;span class="n">-DestinationCluster&lt;/span> &lt;span class="nv">$oldClusterName&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">124&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nv">$peerVserver&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVserverPeer&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="ln">125&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserverUuid&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceVserverUuid&lt;/span> &lt;span class="o">-and&lt;/span>
&lt;span class="ln">126&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">VserverUuid&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationVserverUuid&lt;/span>
&lt;span class="ln">127&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">128&lt;/span> &lt;span class="p">)&lt;/span>
&lt;span class="ln">129&lt;/span> &lt;span class="p">){&lt;/span>
&lt;span class="ln">130&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Found healthy snapmirror for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">, source cluster &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peerVserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerCluster&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - ready for cutover.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">131&lt;/span> &lt;span class="nv">$peerCluster&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$peerVserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerCluster&lt;/span>
&lt;span class="ln">132&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$IPTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;span class="ln">133&lt;/span> &lt;span class="nv">$IPTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Read-Host&lt;/span> &lt;span class="n">-Prompt&lt;/span> &lt;span class="s2">&amp;#34;Enter IP for: $peerCluster&amp;#34;&lt;/span>
&lt;span class="ln">134&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">135&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$CredentialTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;span class="ln">136&lt;/span> &lt;span class="nv">$CredentialTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-Credential&lt;/span> &lt;span class="n">-Message&lt;/span> &lt;span class="s2">&amp;#34;Enter Credentials for: $peerCluster&amp;#34;&lt;/span> &lt;span class="n">-UserName&lt;/span> &lt;span class="s2">&amp;#34;admin&amp;#34;&lt;/span>
&lt;span class="ln">137&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">138&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">])){&lt;/span>
&lt;span class="ln">139&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Connect-NcController&lt;/span> &lt;span class="n">-HTTPS&lt;/span> &lt;span class="n">-Credential&lt;/span> &lt;span class="nv">$CredentialTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$IPTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="ln">140&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">141&lt;/span>
&lt;span class="ln">142&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Get-NcVol&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceVolume&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$oldSnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceVserver&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]){&lt;/span>
&lt;span class="ln">143&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Found healthy snapmirror for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$OldSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">, source cluster &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peerVserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerCluster&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> - successfully validated volume on source cluster.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">144&lt;/span> &lt;span class="nv">$curVol&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nv">$_&lt;/span>
&lt;span class="ln">145&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nb">Get-NcClusterPeer&lt;/span> &lt;span class="n">-Name&lt;/span> &lt;span class="nv">$peerCluster&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">146&lt;/span> &lt;span class="nb">Write-Host&lt;/span> &lt;span class="n">-Object&lt;/span> &lt;span class="s2">&amp;#34;Cluster Peering between $peerCluster and $newClusterName does not exist, please peer first!&amp;#34;&lt;/span>
&lt;span class="ln">147&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="ln">148&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">149&lt;/span>
&lt;span class="ln">150&lt;/span> &lt;span class="c"># Check if Destination SVM is peered with source vserver&lt;/span>
&lt;span class="ln">151&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(!(&lt;/span>&lt;span class="nv">$peerrelationship&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Get-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$peervserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserver&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">-Application&lt;/span> &lt;span class="s2">&amp;#34;snapmirror&amp;#34;&lt;/span>&lt;span class="p">)){&lt;/span>
&lt;span class="ln">152&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Creating new vServer Peer Relationship for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peervserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">153&lt;/span> &lt;span class="nv">$peerrelationship&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">New-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$peervserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserver&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">-Application&lt;/span> &lt;span class="s2">&amp;#34;snapmirror&amp;#34;&lt;/span> &lt;span class="n">-PeerCluster&lt;/span> &lt;span class="nv">$newClusterName&lt;/span>
&lt;span class="ln">154&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">155&lt;/span>
&lt;span class="ln">156&lt;/span> &lt;span class="c"># Check if SVM Peer is unitialized&lt;/span>
&lt;span class="ln">157&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$peerrelationship&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerState&lt;/span> &lt;span class="o">-eq&lt;/span> &lt;span class="s2">&amp;#34;initiated&amp;#34;&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="ln">158&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Confirming vServer Peer Relationship for &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$peervserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserver&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$newClusterName&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$NewSVM&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">159&lt;/span> &lt;span class="nv">$null&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">Confirm-NcVserverPeer&lt;/span> &lt;span class="n">-Vserver&lt;/span> &lt;span class="nv">$NewSVM&lt;/span> &lt;span class="n">-PeerVserver&lt;/span> &lt;span class="nv">$peervserver&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PeerVserver&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln">160&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">161&lt;/span>
&lt;span class="ln">162&lt;/span> &lt;span class="c"># Stop replicating from source to old cluster&lt;/span>
&lt;span class="ln">163&lt;/span> &lt;span class="c">## Quiesce Snapmirror on old cluster from source cluster&lt;/span>
&lt;span class="ln">164&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Quiscing Snapmirror from &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">165&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorQuiesce&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span>
&lt;span class="ln">166&lt;/span>
&lt;span class="ln">167&lt;/span> &lt;span class="c"># Break Relationship new cluster to old cluster &lt;/span>
&lt;span class="ln">168&lt;/span> &lt;span class="c">## Quiesce Snapmirror on new cluster from old cluster&lt;/span>
&lt;span class="ln">169&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Quiscing Snapmirror from &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">170&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorQuiesce&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span>
&lt;span class="ln">171&lt;/span>
&lt;span class="ln">172&lt;/span> &lt;span class="c">## Break Snapmirror on new cluster from old cluster&lt;/span>
&lt;span class="ln">173&lt;/span> &lt;span class="nb">Write-Host&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Break Snapmirror from &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2"> to &lt;/span>&lt;span class="p">$(&lt;/span>&lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="ln">174&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorBreak&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">175&lt;/span>
&lt;span class="ln">176&lt;/span> &lt;span class="c">## Delete Snapmirror on new cluster from old cluster&lt;/span>
&lt;span class="ln">177&lt;/span> &lt;span class="nb">Remove-NcSnapmirror&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">178&lt;/span>
&lt;span class="ln">179&lt;/span> &lt;span class="c">## Release Snapmirror on old cluster to new cluster&lt;/span>
&lt;span class="ln">180&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorRelease&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">181&lt;/span>
&lt;span class="ln">182&lt;/span> &lt;span class="c"># Build Snapmirror to new cluster from source cluster and cleanup&lt;/span>
&lt;span class="ln">183&lt;/span> &lt;span class="c">## Create new snapmirror&lt;/span>
&lt;span class="ln">184&lt;/span> &lt;span class="nb">New-NcSnapmirror&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Schedule&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Schedule&lt;/span> &lt;span class="n">-Policy&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Policy&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="n">-Type&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PolicyType&lt;/span>
&lt;span class="ln">185&lt;/span>
&lt;span class="ln">186&lt;/span> &lt;span class="c">## Resync new snapmirror&lt;/span>
&lt;span class="ln">187&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorResync&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$snapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$newCluster&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">188&lt;/span>
&lt;span class="ln">189&lt;/span> &lt;span class="c">## Break Snapmirror on old cluster from source cluster&lt;/span>
&lt;span class="ln">190&lt;/span> &lt;span class="nb">Invoke-NcSnapmirrorRelease&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$ClusterTable&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$peerCluster&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">191&lt;/span>
&lt;span class="ln">192&lt;/span> &lt;span class="c">## Delete Snapmirror on old cluster from source cluster&lt;/span>
&lt;span class="ln">193&lt;/span> &lt;span class="nb">Remove-NcSnapmirror&lt;/span> &lt;span class="n">-Destination&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">DestinationLocation&lt;/span> &lt;span class="n">-Source&lt;/span> &lt;span class="nv">$oldsnapmirror&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">SourceLocation&lt;/span> &lt;span class="n">-Controller&lt;/span> &lt;span class="nv">$oldCluster&lt;/span> &lt;span class="n">-Confirm&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="nv">$false&lt;/span>
&lt;span class="ln">194&lt;/span>
&lt;span class="ln">195&lt;/span> &lt;span class="c">## Add Volume to calculated blacklist&lt;/span>
&lt;span class="ln">196&lt;/span> &lt;span class="nv">$calculatedBlacklist&lt;/span> &lt;span class="p">+=&lt;/span> &lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>
&lt;span class="ln">197&lt;/span>
&lt;span class="ln">198&lt;/span> &lt;span class="nb">Start-Sleep&lt;/span> &lt;span class="n">-Seconds&lt;/span> &lt;span class="n">15&lt;/span>
&lt;span class="ln">199&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">200&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">201&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="ln">202&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="ln">203&lt;/span>
&lt;span class="ln">204&lt;/span>&lt;span class="c">#endregion&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Post and Collaboration Guide</title><link>https://system32.blog/post/howtopost/</link><pubDate>Fri, 20 Aug 2021 00:00:00 +0000</pubDate><guid>https://system32.blog/post/howtopost/</guid><description>
&lt;p>This article offers a quick guide on how to collaborate on the blog and submit / update posts.&lt;/p>
&lt;h1 id="introduction">Introduction&lt;/h1>
&lt;p>The system32.blog is powered by a static site generator called Hugo and the &lt;a href="https://github.com/chipzoller/hugo-clarity">Clarity Theme&lt;/a>.
All content is written in Markdown and hosted on Github which allows anyone to submit posts or collaborate on existing ones.&lt;/p>
&lt;h1 id="how-to-contribute">How to contribute?&lt;/h1>
&lt;p>To contibute to the block, please fork the repository &lt;a href="https://github.com/system32blog/blog">system32blog/blog&lt;/a> and update or add a post under &lt;code>/content/post&lt;/code>.
If your change is ready in your opinion, please raise a pull request to the &lt;code>preview&lt;/code> branch on &lt;a href="https://github.com/system32blog/blog">system32blog/blog&lt;/a>.&lt;/p>
&lt;p>&lt;code>Scroll down further to see a video which describes the process.&lt;/code>&lt;/p>
&lt;h2 id="license">License&lt;/h2>
&lt;p>Please note that all content you submit will fall under the &lt;a href="https://github.com/system32blog/blog/blob/preview/LICENSE">MIT License&lt;/a>. We will remove blog posts based on the authors request, but the content will stay in the Git Revision history.&lt;/p>
&lt;h1 id="preview-posts">Preview posts&lt;/h1>
&lt;p>After your pull request was accepted, you can preview your post on &lt;a href="https://preview.system32.blog">preview.system32.blog&lt;/a>.
We'll review the formatting there and move it into the &lt;code>master&lt;/code> branch.&lt;/p>
&lt;h1 id="posting">Posting&lt;/h1>
&lt;p>To submit a new post, please create a new file under &lt;a href="https://github.com/system32blog/blog/tree/preview/content/post">&lt;code>/content/post/&lt;/code>&lt;/a> with a meaningful name like &lt;code>whataregrouppolicypreferences.md&lt;/code>.
The post needs a set of metadata information, please follow this guidance.&lt;/p>
&lt;h2 id="syntax">Syntax&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="ln"> 1&lt;/span>+++
&lt;span class="ln"> 2&lt;/span>title = &amp;#34;Post and Collaboration Guide&amp;#34; &lt;span class="c">&amp;lt;!--- A meaningful title ---&amp;gt;&lt;/span>
&lt;span class="ln"> 3&lt;/span>date = &amp;#34;2021-08-20&amp;#34; # Date in Format yyyy-MM-dd ---&amp;gt;
&lt;span class="ln"> 4&lt;/span>description = &amp;#34;An article describing the process to collaborate on the blog.&amp;#34; &lt;span class="c">&amp;lt;!--- A short description for the search engine ---&amp;gt;&lt;/span>
&lt;span class="ln"> 5&lt;/span>featured = false &lt;span class="c">&amp;lt;!--- Please don&amp;#39;t change ---&amp;gt;&lt;/span>
&lt;span class="ln"> 6&lt;/span>tags = [
&lt;span class="ln"> 7&lt;/span> &amp;#34;Robin Beismann&amp;#34; &lt;span class="c">&amp;lt;!--- Put yourself as author here, realname, nickname or github username is fine ---&amp;gt;&lt;/span>
&lt;span class="ln"> 8&lt;/span>]
&lt;span class="ln"> 9&lt;/span>categories = [
&lt;span class="ln">10&lt;/span> &amp;#34;blogging&amp;#34; &lt;span class="c">&amp;lt;!--- Categories, please have a look at the existing ones or invent a new one if there is none that fits ---&amp;gt;&lt;/span>
&lt;span class="ln">11&lt;/span>]
&lt;span class="ln">12&lt;/span>series = [&amp;#34;&amp;#34;] &lt;span class="c">&amp;lt;!--- If this is a blog series, put a meaningful name here, otherwise leave empty ---&amp;gt;&lt;/span>
&lt;span class="ln">13&lt;/span>thumbnail = &amp;#34;images/building.png&amp;#34; &lt;span class="c">&amp;lt;!--- Use one of the thumbnails under /images/ or submit a new one. Please note that you need to have the rights on it. ---&amp;gt;&lt;/span>
&lt;span class="ln">14&lt;/span>+++ &lt;span class="c">&amp;lt;!--- This is a separator, please leave in-place ---&amp;gt;&lt;/span>
&lt;span class="ln">15&lt;/span>This article offers a quick guide on how to collaborate on the blog and submit / update posts. &lt;span class="c">&amp;lt;!--- The preview line the start page, please leave the next line in-place ---&amp;gt;&lt;/span>
&lt;span class="ln">16&lt;/span>&lt;span class="c">&amp;lt;!--more--&amp;gt;&lt;/span>
&lt;span class="ln">17&lt;/span>
&lt;span class="ln">18&lt;/span>&lt;span class="gh"># First heading
&lt;/span>&lt;span class="ln">19&lt;/span>&lt;span class="gh">&lt;/span>More text to follow
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Feel free to check out the formatting on any other post under &lt;a href="https://github.com/system32blog/blog/tree/preview/content/post">&lt;code>/content/post/&lt;/code>&lt;/a>.&lt;/p>
&lt;h2 id="referencing-media">Referencing media&lt;/h2>
&lt;p>If you want to reference pictures or other content in your posts, please submit them under &lt;code>&amp;quot;/static/post/&amp;lt;your post name without extension&amp;gt;&amp;quot;&lt;/code>.
You can then reference them using:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="ln">1&lt;/span>![&lt;span class="nt">describing text&lt;/span>](&lt;span class="na">logo_red.png&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="how-to-use-visual-studio-code-for-git-in-a-webbrowser">How to use Visual Studio Code for Git in a Webbrowser&lt;/h2>
&lt;p>This animation shows how you can check in posts without any Git Client or Markdown editor on your computer.
&lt;img src="howtopost.gif" alt="example animation">&lt;/p></description></item></channel></rss>